{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/AddGiftForm.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useCallback } from 'react'\nimport { createClient } from '@/lib/supabase'\nimport { useRouter } from 'next/navigation'\n\ninterface Member {\n  id: string;\n  name: string;\n}\n\ninterface AddGiftFormProps {\n  familyId: string;\n  currentUserId: string;\n  members: Member[];\n}\n\n// Debounce function defined outside the component to be stable\nconst debounce = <T extends (...args: any[]) => any>(func: T, delay: number): ((...args: Parameters<T>) => void) => {\n  let timeout: NodeJS.Timeout | null = null\n  return (...args: Parameters<T>) => {\n    if (timeout) {\n      clearTimeout(timeout)\n    }\n    timeout = setTimeout(() => {\n      func(...args)\n    }, delay)\n  }\n}\n\nexport default function AddGiftForm({ familyId, currentUserId, members }: AddGiftFormProps) {\n  const [newGiftDescription, setNewGiftDescription] = useState('')\n  const [newGiftNotes, setNewGiftNotes] = useState('')\n  const [newGiftPrice, setNewGiftPrice] = useState<string>('')\n  const [newProductUrl, setNewProductUrl] = useState('')\n  const [fetchedProductTitle, setFetchedProductTitle] = useState('')\n  const [fetchedProductImageUrl, setFetchedProductImageUrl] = useState('')\n  const [fetchedProductPrice, setFetchedProductPrice] = useState<string>('')\n  const [isFetchingMetadata, setIsFetchingMetadata] = useState(false)\n  const [selectedRecipientId, setSelectedRecipientId] = useState(currentUserId) // Default to current user\n  const [message, setMessage] = useState('')\n  const supabase = createClient()\n  const router = useRouter()\n\n  const fetchMetadata = useCallback(async (url: string) => {\n    if (!url || !url.startsWith('http')) {\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n      return\n    }\n\n    setIsFetchingMetadata(true)\n    try {\n      const res = await fetch('/api/gifts/fetch-metadata', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ url }),\n      })\n      const data = await res.json()\n\n      if (res.ok) {\n        setFetchedProductTitle(data.title || '')\n        setFetchedProductImageUrl(data.imageUrl || '')\n        setFetchedProductPrice(data.price ? data.price.toFixed(2) : '')\n        // If price is fetched, pre-fill the gift price field\n        if (data.price) setNewGiftPrice(data.price.toFixed(2))\n      } else {\n        setMessage(`Failed to fetch metadata: ${data.error}`)\n        setFetchedProductTitle('')\n        setFetchedProductImageUrl('')\n        setFetchedProductPrice('')\n      }\n    } catch (error: unknown) {\n      let errorMessage = 'Error fetching metadata';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      } else if (typeof error === 'string') {\n        errorMessage = error;\n      }\n      setMessage(`Error fetching metadata: ${errorMessage}`)\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n    } finally {\n      setIsFetchingMetadata(false)\n    }\n  }, [])\n\n  const debouncedFetchMetadata = useCallback(debounce(fetchMetadata, 700), [fetchMetadata])\n\n  const handleAddGift = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setMessage('')\n\n    if (!newGiftDescription && !fetchedProductTitle) {\n      setMessage('Gift description or fetched product title is required.')\n      return\n    }\n\n    if (!selectedRecipientId) {\n      setMessage('Please select a recipient.')\n      return\n    }\n\n    // Get the current max order_index for the list\n    const { data: maxOrderData, error: _maxOrderError } = await supabase\n      .from('items')\n      .select('order_index')\n      .eq('list_id', familyId)\n      .order('order_index', { ascending: false })\n      .limit(1)\n      .single()\n\n    const nextOrderIndex = maxOrderData ? maxOrderData.order_index + 1 : 0;\n\n    const { error } = await supabase\n      .from('items')\n      .insert([{\n        list_id: familyId,\n        user_id: selectedRecipientId,\n        name: newGiftDescription || fetchedProductTitle, // Use fetched title if description is empty\n        notes: newGiftNotes || null,\n        price: newGiftPrice ? parseFloat(newGiftPrice) : (fetchedProductPrice ? parseFloat(fetchedProductPrice) : null),\n        order_index: nextOrderIndex,\n        product_url: newProductUrl || null,\n        product_title: fetchedProductTitle || null,\n        product_image_url: fetchedProductImageUrl || null,\n        product_price: fetchedProductPrice ? parseFloat(fetchedProductPrice) : null,\n      }])\n\n    if (error) {\n      setMessage(`Failed to add gift: ${error.message}`)\n    } else {\n      setMessage(`Gift \"${newGiftDescription || fetchedProductTitle}\" added successfully!`)\n      setNewGiftDescription('')\n      setNewGiftNotes('')\n      setNewGiftPrice('')\n      setNewProductUrl('')\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n      router.refresh() // Refresh the current page to show the new gift\n    }\n  }\n\n  return (\n    <div className=\"mt-6 pt-4 border-t border-gray-200 bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md\">\n      <h3 className=\"text-xl font-semibold mb-3\">Add a Gift</h3>\n      {message && <p className=\"text-red-500 mb-3\">{message}</p>}\n      <form onSubmit={handleAddGift} className=\"space-y-3\">\n        <div>\n          <label htmlFor=\"recipient\" className=\"block text-sm font-medium text-gray-300\">Recipient</label>\n          <select\n            id=\"recipient\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={selectedRecipientId}\n            onChange={(e) => setSelectedRecipientId(e.target.value)}\n            required\n          >\n            {members.map((member) => (\n              <option key={member.id} value={member.id}>\n                {member.name} {member.id === currentUserId ? '(You)' : ''}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div>\n          <label htmlFor=\"product-url\" className=\"block text-sm font-medium text-gray-300\">\n            Product URL (Optional)\n          </label>\n          <input\n            type=\"url\"\n            id=\"product-url\"\n            placeholder=\"e.g., https://example.com/product\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newProductUrl}\n            onChange={(e) => {\n              setNewProductUrl(e.target.value)\n              debouncedFetchMetadata(e.target.value)\n            }}\n            onBlur={(e) => fetchMetadata(e.target.value)}\n          />\n          {isFetchingMetadata && <p className=\"text-sm text-gray-500 mt-1\">Fetching product details...</p>}\n          {fetchedProductTitle && (\n            <div className=\"mt-2 p-2 border border-gray-200 dark:border-gray-700 rounded-md flex items-center space-x-3\">\n              {fetchedProductImageUrl && (\n                // eslint-disable-next-line @next/next/no-img-element\n                <img src={fetchedProductImageUrl} alt={fetchedProductTitle} className=\"w-16 h-16 object-cover rounded-md\" />\n              )}\n              <div>\n                <p className=\"font-semibold text-gray-700 dark:text-gray-200\">{fetchedProductTitle}</p>\n                {fetchedProductPrice && <p className=\"text-sm text-gray-600 dark:text-gray-300\">${fetchedProductPrice}</p>}\n              </div>\n            </div>\n          )}\n        </div>\n        <div>\n          <label htmlFor=\"gift-desc\" className=\"block text-sm font-medium text-gray-300\">\n            Gift Description (or use fetched title)\n          </label>\n          <input\n            type=\"text\"\n            id=\"gift-desc\"\n            placeholder=\"Gift description\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newGiftDescription}\n            onChange={(e) => setNewGiftDescription(e.target.value)}\n            required={!fetchedProductTitle} // Required only if no title is fetched\n          />\n        </div>\n        <div>\n          <label htmlFor=\"gift-notes\" className=\"block text-sm font-medium text-gray-300\">\n            Notes (Optional)\n          </label>\n          <textarea\n            id=\"gift-notes\"\n            placeholder=\"e.g., Size M, color blue, link to product\"\n            rows={3}\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newGiftNotes}\n            onChange={(e) => setNewGiftNotes(e.target.value)}\n          />\n        </div>\n        <div>\n          <label htmlFor=\"gift-price\" className=\"block text-sm font-medium text-gray-300\">\n            Price (Optional)\n          </label>\n          <input\n            type=\"number\"\n            id=\"gift-price\"\n            placeholder=\"e.g., 25.99\"\n            step=\"0.01\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newGiftPrice}\n            onChange={(e) => setNewGiftPrice(e.target.value)}\n          />\n        </div>\n        <button\n          type=\"submit\"\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm\"\n        >\n          Add Gift\n        </button>\n      </form>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;;;AAJA;;;;AAiBA,+DAA+D;AAC/D,MAAM,WAAW,CAAoC,MAAS;IAC5D,IAAI,UAAiC;IACrC,OAAO,CAAC,GAAG;QACT,IAAI,SAAS;YACX,aAAa;QACf;QACA,UAAU,WAAW;YACnB,QAAQ;QACV,GAAG;IACL;AACF;AAEe,SAAS,YAAY,EAAE,QAAQ,EAAE,aAAa,EAAE,OAAO,EAAoB;;IACxF,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAC;IAC7D,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAC;IACjD,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,yKAAQ,EAAS;IACzD,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAC;IAC/D,MAAM,CAAC,wBAAwB,0BAA0B,GAAG,IAAA,yKAAQ,EAAC;IACrE,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAS;IACvE,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,yKAAQ,EAAC;IAC7D,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,yKAAQ,EAAC,eAAe,0BAA0B;;IACxG,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,WAAW,IAAA,yIAAY;IAC7B,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,gBAAgB,IAAA,4KAAW;kDAAC,OAAO;YACvC,IAAI,CAAC,OAAO,CAAC,IAAI,UAAU,CAAC,SAAS;gBACnC,uBAAuB;gBACvB,0BAA0B;gBAC1B,uBAAuB;gBACvB;YACF;YAEA,sBAAsB;YACtB,IAAI;gBACF,MAAM,MAAM,MAAM,MAAM,6BAA6B;oBACnD,QAAQ;oBACR,SAAS;wBAAE,gBAAgB;oBAAmB;oBAC9C,MAAM,KAAK,SAAS,CAAC;wBAAE;oBAAI;gBAC7B;gBACA,MAAM,OAAO,MAAM,IAAI,IAAI;gBAE3B,IAAI,IAAI,EAAE,EAAE;oBACV,uBAAuB,KAAK,KAAK,IAAI;oBACrC,0BAA0B,KAAK,QAAQ,IAAI;oBAC3C,uBAAuB,KAAK,KAAK,GAAG,KAAK,KAAK,CAAC,OAAO,CAAC,KAAK;oBAC5D,qDAAqD;oBACrD,IAAI,KAAK,KAAK,EAAE,gBAAgB,KAAK,KAAK,CAAC,OAAO,CAAC;gBACrD,OAAO;oBACL,WAAW,CAAC,0BAA0B,EAAE,KAAK,KAAK,EAAE;oBACpD,uBAAuB;oBACvB,0BAA0B;oBAC1B,uBAAuB;gBACzB;YACF,EAAE,OAAO,OAAgB;gBACvB,IAAI,eAAe;gBACnB,IAAI,iBAAiB,OAAO;oBAC1B,eAAe,MAAM,OAAO;gBAC9B,OAAO,IAAI,OAAO,UAAU,UAAU;oBACpC,eAAe;gBACjB;gBACA,WAAW,CAAC,yBAAyB,EAAE,cAAc;gBACrD,uBAAuB;gBACvB,0BAA0B;gBAC1B,uBAAuB;YACzB,SAAU;gBACR,sBAAsB;YACxB;QACF;iDAAG,EAAE;IAEL,MAAM,yBAAyB,IAAA,4KAAW,EAAC,SAAS,eAAe,MAAM;QAAC;KAAc;IAExF,MAAM,gBAAgB,OAAO;QAC3B,EAAE,cAAc;QAChB,WAAW;QAEX,IAAI,CAAC,sBAAsB,CAAC,qBAAqB;YAC/C,WAAW;YACX;QACF;QAEA,IAAI,CAAC,qBAAqB;YACxB,WAAW;YACX;QACF;QAEA,+CAA+C;QAC/C,MAAM,EAAE,MAAM,YAAY,EAAE,OAAO,cAAc,EAAE,GAAG,MAAM,SACzD,IAAI,CAAC,SACL,MAAM,CAAC,eACP,EAAE,CAAC,WAAW,UACd,KAAK,CAAC,eAAe;YAAE,WAAW;QAAM,GACxC,KAAK,CAAC,GACN,MAAM;QAET,MAAM,iBAAiB,eAAe,aAAa,WAAW,GAAG,IAAI;QAErE,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,SACL,MAAM,CAAC;YAAC;gBACP,SAAS;gBACT,SAAS;gBACT,MAAM,sBAAsB;gBAC5B,OAAO,gBAAgB;gBACvB,OAAO,eAAe,WAAW,gBAAiB,sBAAsB,WAAW,uBAAuB;gBAC1G,aAAa;gBACb,aAAa,iBAAiB;gBAC9B,eAAe,uBAAuB;gBACtC,mBAAmB,0BAA0B;gBAC7C,eAAe,sBAAsB,WAAW,uBAAuB;YACzE;SAAE;QAEJ,IAAI,OAAO;YACT,WAAW,CAAC,oBAAoB,EAAE,MAAM,OAAO,EAAE;QACnD,OAAO;YACL,WAAW,CAAC,MAAM,EAAE,sBAAsB,oBAAoB,qBAAqB,CAAC;YACpF,sBAAsB;YACtB,gBAAgB;YAChB,gBAAgB;YAChB,iBAAiB;YACjB,uBAAuB;YACvB,0BAA0B;YAC1B,uBAAuB;YACvB,OAAO,OAAO,IAAG,gDAAgD;QACnE;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAA6B;;;;;;YAC1C,yBAAW,6LAAC;gBAAE,WAAU;0BAAqB;;;;;;0BAC9C,6LAAC;gBAAK,UAAU;gBAAe,WAAU;;kCACvC,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAY,WAAU;0CAA0C;;;;;;0CAC/E,6LAAC;gCACC,IAAG;gCACH,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,uBAAuB,EAAE,MAAM,CAAC,KAAK;gCACtD,QAAQ;0CAEP,QAAQ,GAAG,CAAC,CAAC,uBACZ,6LAAC;wCAAuB,OAAO,OAAO,EAAE;;4CACrC,OAAO,IAAI;4CAAC;4CAAE,OAAO,EAAE,KAAK,gBAAgB,UAAU;;uCAD5C,OAAO,EAAE;;;;;;;;;;;;;;;;kCAM5B,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAc,WAAU;0CAA0C;;;;;;0CAGjF,6LAAC;gCACC,MAAK;gCACL,IAAG;gCACH,aAAY;gCACZ,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC;oCACT,iBAAiB,EAAE,MAAM,CAAC,KAAK;oCAC/B,uBAAuB,EAAE,MAAM,CAAC,KAAK;gCACvC;gCACA,QAAQ,CAAC,IAAM,cAAc,EAAE,MAAM,CAAC,KAAK;;;;;;4BAE5C,oCAAsB,6LAAC;gCAAE,WAAU;0CAA6B;;;;;;4BAChE,qCACC,6LAAC;gCAAI,WAAU;;oCACZ,0BACC,qDAAqD;kDACrD,6LAAC;wCAAI,KAAK;wCAAwB,KAAK;wCAAqB,WAAU;;;;;;kDAExE,6LAAC;;0DACC,6LAAC;gDAAE,WAAU;0DAAkD;;;;;;4CAC9D,qCAAuB,6LAAC;gDAAE,WAAU;;oDAA2C;oDAAE;;;;;;;;;;;;;;;;;;;;;;;;;kCAK1F,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAY,WAAU;0CAA0C;;;;;;0CAG/E,6LAAC;gCACC,MAAK;gCACL,IAAG;gCACH,aAAY;gCACZ,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,sBAAsB,EAAE,MAAM,CAAC,KAAK;gCACrD,UAAU,CAAC;;;;;;;;;;;;kCAGf,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAa,WAAU;0CAA0C;;;;;;0CAGhF,6LAAC;gCACC,IAAG;gCACH,aAAY;gCACZ,MAAM;gCACN,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;kCAGnD,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAa,WAAU;0CAA0C;;;;;;0CAGhF,6LAAC;gCACC,MAAK;gCACL,IAAG;gCACH,aAAY;gCACZ,MAAK;gCACL,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,gBAAgB,EAAE,MAAM,CAAC,KAAK;;;;;;;;;;;;kCAGnD,6LAAC;wBACC,MAAK;wBACL,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT;GAzNwB;;QAYP,kJAAS;;;KAZF","debugId":null}},
    {"offset": {"line": 416, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/ClaimUnclaimButtons.tsx"],"sourcesContent":["'use client'\n\nimport { useRouter } from 'next/navigation'\nimport { useState } from 'react'\n\ninterface Gift {\n  id: string;\n  description: string;\n  is_purchased: boolean;\n  purchased_by?: string;\n  user_id: string;\n}\n\ninterface ClaimUnclaimButtonsProps {\n  gift: Gift;\n  userId: string;\n}\n\nexport default function ClaimUnclaimButtons({ gift, userId }: ClaimUnclaimButtonsProps) {\n  const [message, setMessage] = useState('')\n  const router = useRouter()\n\n  const handleClaimGift = async () => {\n    setMessage('')\n    const res = await fetch(`/api/gifts/${gift.id}/claim`, {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ claimedByUserId: userId }),\n    })\n\n    if (res.ok) {\n      setMessage('Gift claimed successfully!')\n      router.refresh()\n    } else {\n      const errorText = await res.text()\n      setMessage(`Failed to claim gift: ${errorText}`)\n    }\n  }\n\n  const handleUnclaimGift = async () => {\n    setMessage('')\n    const res = await fetch(`/api/gifts/${gift.id}/unclaim`, {\n      method: 'PATCH', // Changed to PATCH as per API route\n      headers: { 'Content-Type': 'application/json' },\n    })\n\n    if (res.ok) {\n      setMessage('Gift unclaimed successfully!')\n      router.refresh()\n    } else {\n      const errorText = await res.text()\n      setMessage(`Failed to unclaim gift: ${errorText}`)\n    }\n  }\n\n  return (\n    <div>\n      {message && <p className=\"text-red-500 text-sm mb-2\">{message}</p>}\n      {!gift.is_purchased && (\n        <button\n          onClick={handleClaimGift}\n          className=\"ml-4 px-3 py-1 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm\"\n        >\n          Claim\n        </button>\n      )}\n      {gift.is_purchased && gift.purchased_by === userId && (\n        <button\n          onClick={handleUnclaimGift}\n          className=\"ml-4 px-3 py-1 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 text-sm\"\n        >\n          Unclaim\n        </button>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;;;AAHA;;;AAkBe,SAAS,oBAAoB,EAAE,IAAI,EAAE,MAAM,EAA4B;;IACpF,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,kBAAkB;QACtB,WAAW;QACX,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,KAAK,EAAE,CAAC,MAAM,CAAC,EAAE;YACrD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,iBAAiB;YAAO;QACjD;QAEA,IAAI,IAAI,EAAE,EAAE;YACV,WAAW;YACX,OAAO,OAAO;QAChB,OAAO;YACL,MAAM,YAAY,MAAM,IAAI,IAAI;YAChC,WAAW,CAAC,sBAAsB,EAAE,WAAW;QACjD;IACF;IAEA,MAAM,oBAAoB;QACxB,WAAW;QACX,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE;YACvD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAChD;QAEA,IAAI,IAAI,EAAE,EAAE;YACV,WAAW;YACX,OAAO,OAAO;QAChB,OAAO;YACL,MAAM,YAAY,MAAM,IAAI,IAAI;YAChC,WAAW,CAAC,wBAAwB,EAAE,WAAW;QACnD;IACF;IAEA,qBACE,6LAAC;;YACE,yBAAW,6LAAC;gBAAE,WAAU;0BAA6B;;;;;;YACrD,CAAC,KAAK,YAAY,kBACjB,6LAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;YAIF,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK,wBAC1C,6LAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;;;;;;;AAMT;GA1DwB;;QAEP,kJAAS;;;KAFF","debugId":null}},
    {"offset": {"line": 517, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/AddMemberForm.tsx"],"sourcesContent":["import { createClient } from '@/lib/supabase'\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\n\ninterface AddMemberFormProps {\n  familyId: string;\n  currentUserId: string;\n  members: { id: string; name: string }[];\n}\n\nexport default function AddMemberForm({ familyId, currentUserId, members }: AddMemberFormProps) {\n  const [newMemberName, setNewMemberName] = useState('')\n  const [newMemberEmail, setNewMemberEmail] = useState('') // Assuming email for finding user ID\n  const [message, setMessage] = useState('')\n  const supabase = createClient()\n  const router = useRouter()\n\n  const handleAddMember = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setMessage('')\n\n    console.log(\"Attempting to add member:\", { newMemberName, newMemberEmail, familyId, currentUserId });\n\n    if (!newMemberName || !newMemberEmail) {\n      setMessage('Member name and email are required.')\n      return\n    }\n\n    // First, check if the current user is part of this family list\n    const isCurrentUserMember = members.some(member => member.id === currentUserId);\n    if (!isCurrentUserMember) {\n      setMessage('You must be a member of this list to add new members.');\n      return;\n    }\n\n    try {\n      const res = await fetch(`/api/lists/${familyId}/members`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ memberName: newMemberName, memberEmail: newMemberEmail }),\n      });\n\n      console.log(\"API response status:\", res.status);\n      const data = await res.json();\n      console.log(\"API response data:\", data);\n\n      if (res.ok) {\n        setMessage(data.message);\n        setNewMemberName('');\n        setNewMemberEmail('');\n        router.refresh(); // Refresh the page to show the new member in the dropdowns\n      } else {\n        setMessage(`Failed to add member: ${data.error}`);\n      }\n    } catch (error: unknown) {\n      let errorMessage = 'Error adding member';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      } else if (typeof error === 'string') {\n        errorMessage = error;\n      }\n      setMessage(`Error adding member: ${errorMessage}`);\n      console.error(\"Error during add member fetch:\", error);\n    }\n  }\n\n  return (\n    <div className=\"mt-8 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md\">\n      <h3 className=\"text-2xl font-semibold mb-4\">Add New Family Member</h3>\n      {message && <p className=\"text-red-500 mb-4\">{message}</p>}\n      <form onSubmit={handleAddMember} className=\"space-y-4\">\n        <div>\n          <label htmlFor=\"newMemberName\" className=\"block text-sm font-medium text-gray-300\">Member Name</label>\n          <input\n            type=\"text\"\n            id=\"newMemberName\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newMemberName}\n            onChange={(e) => setNewMemberName(e.target.value)}\n            required\n          />\n        </div>\n        <div>\n          <label htmlFor=\"newMemberEmail\" className=\"block text-sm font-medium text-gray-300\">Member Email</label>\n          <input\n            type=\"email\"\n            id=\"newMemberEmail\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newMemberEmail}\n            onChange={(e) => setNewMemberEmail(e.target.value)}\n            required\n          />\n        </div>\n        <button\n          type=\"submit\"\n          className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm\"\n        >\n          Add Member\n        </button>\n      </form>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;;AAQe,SAAS,cAAc,EAAE,QAAQ,EAAE,aAAa,EAAE,OAAO,EAAsB;;IAC5F,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,yKAAQ,EAAC;IACnD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,yKAAQ,EAAC,IAAI,qCAAqC;;IAC9F,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,WAAW,IAAA,yIAAY;IAC7B,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,kBAAkB,OAAO;QAC7B,EAAE,cAAc;QAChB,WAAW;QAEX,QAAQ,GAAG,CAAC,6BAA6B;YAAE;YAAe;YAAgB;YAAU;QAAc;QAElG,IAAI,CAAC,iBAAiB,CAAC,gBAAgB;YACrC,WAAW;YACX;QACF;QAEA,+DAA+D;QAC/D,MAAM,sBAAsB,QAAQ,IAAI,CAAC,CAAA,SAAU,OAAO,EAAE,KAAK;QACjE,IAAI,CAAC,qBAAqB;YACxB,WAAW;YACX;QACF;QAEA,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,SAAS,QAAQ,CAAC,EAAE;gBACxD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,YAAY;oBAAe,aAAa;gBAAe;YAChF;YAEA,QAAQ,GAAG,CAAC,wBAAwB,IAAI,MAAM;YAC9C,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,QAAQ,GAAG,CAAC,sBAAsB;YAElC,IAAI,IAAI,EAAE,EAAE;gBACV,WAAW,KAAK,OAAO;gBACvB,iBAAiB;gBACjB,kBAAkB;gBAClB,OAAO,OAAO,IAAI,2DAA2D;YAC/E,OAAO;gBACL,WAAW,CAAC,sBAAsB,EAAE,KAAK,KAAK,EAAE;YAClD;QACF,EAAE,OAAO,OAAgB;YACvB,IAAI,eAAe;YACnB,IAAI,iBAAiB,OAAO;gBAC1B,eAAe,MAAM,OAAO;YAC9B,OAAO,IAAI,OAAO,UAAU,UAAU;gBACpC,eAAe;YACjB;YACA,WAAW,CAAC,qBAAqB,EAAE,cAAc;YACjD,QAAQ,KAAK,CAAC,kCAAkC;QAClD;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAA8B;;;;;;YAC3C,yBAAW,6LAAC;gBAAE,WAAU;0BAAqB;;;;;;0BAC9C,6LAAC;gBAAK,UAAU;gBAAiB,WAAU;;kCACzC,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAgB,WAAU;0CAA0C;;;;;;0CACnF,6LAAC;gCACC,MAAK;gCACL,IAAG;gCACH,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;gCAChD,QAAQ;;;;;;;;;;;;kCAGZ,6LAAC;;0CACC,6LAAC;gCAAM,SAAQ;gCAAiB,WAAU;0CAA0C;;;;;;0CACpF,6LAAC;gCACC,MAAK;gCACL,IAAG;gCACH,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,kBAAkB,EAAE,MAAM,CAAC,KAAK;gCACjD,QAAQ;;;;;;;;;;;;kCAGZ,6LAAC;wBACC,MAAK;wBACL,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT;GA5FwB;;QAKP,kJAAS;;;KALF","debugId":null}},
    {"offset": {"line": 708, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/EditGiftForm.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useCallback } from 'react'\n\ninterface Gift {\n  id: string;\n  description: string;\n  notes?: string;\n  price?: number;\n  product_url?: string;\n  product_title?: string;\n  product_image_url?: string;\n  product_price?: number;\n}\n\ninterface EditGiftFormProps {\n  gift: Gift;\n  onClose: () => void;\n  onSave: () => void;\n}\n\nexport default function EditGiftForm({ gift, onClose, onSave }: EditGiftFormProps) {\n  const [newDescription, setNewDescription] = useState(gift.description)\n  const [newNotes, setNewNotes] = useState(gift.notes || '')\n  const [newPrice, setNewPrice] = useState<string>(gift.price?.toString() || '')\n  const [newProductUrl, setNewProductUrl] = useState(gift.product_url || '')\n  const [fetchedProductTitle, setFetchedProductTitle] = useState(gift.product_title || '')\n  const [fetchedProductImageUrl, setFetchedProductImageUrl] = useState(gift.product_image_url || '')\n  const [fetchedProductPrice, setFetchedProductPrice] = useState<string>(gift.product_price?.toString() || '')\n  const [isFetchingMetadata, setIsFetchingMetadata] = useState(false)\n  const [message, setMessage] = useState('')\n\n// Debounce function defined outside the component to be stable\nconst debounce = <T extends (...args: any[]) => any>(func: T, delay: number): ((...args: Parameters<T>) => void) => {\n  let timeout: NodeJS.Timeout | null = null\n  return (...args: Parameters<T>) => {\n    if (timeout) {\n      clearTimeout(timeout)\n    }\n    timeout = setTimeout(() => {\n      func(...args)\n    }, delay)\n  }\n}\n\n  const fetchMetadata = useCallback(async (url: string) => {\n    if (!url || !url.startsWith('http')) {\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n      return\n    }\n\n    setIsFetchingMetadata(true)\n    try {\n      const res = await fetch('/api/gifts/fetch-metadata', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ url }),\n      })\n      const data = await res.json()\n\n      if (res.ok) {\n        setFetchedProductTitle(data.title || '')\n        setFetchedProductImageUrl(data.imageUrl || '')\n        setFetchedProductPrice(data.price ? data.price.toFixed(2) : '')\n        // If price is fetched, pre-fill the gift price field\n        if (data.price) setNewPrice(data.price.toFixed(2))\n      } else {\n        setMessage(`Failed to fetch metadata: ${data.error}`)\n        setFetchedProductTitle('')\n        setFetchedProductImageUrl('')\n        setFetchedProductPrice('')\n      }\n    } catch (error: unknown) {\n      let errorMessage = 'Error fetching metadata';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      } else if (typeof error === 'string') {\n        errorMessage = error;\n      }\n      setMessage(`Error fetching metadata: ${errorMessage}`)\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n    } finally {\n      setIsFetchingMetadata(false)\n    }\n  }, [])\n\n  const debouncedFetchMetadata = useCallback(debounce(fetchMetadata, 700), [fetchMetadata])\n\n  const handleSave = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setMessage('')\n\n    if (!newDescription) {\n      setMessage('Gift description cannot be empty.')\n      return\n    }\n\n    const res = await fetch(`/api/gifts/${gift.id}`, {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        description: newDescription,\n        notes: newNotes,\n        price: newPrice ? parseFloat(newPrice) : null,\n        product_url: newProductUrl || null,\n        product_title: fetchedProductTitle || null,\n        product_image_url: fetchedProductImageUrl || null,\n        product_price: fetchedProductPrice ? parseFloat(fetchedProductPrice) : null,\n      }),\n    })\n\n    if (res.ok) {\n      setMessage('Gift updated successfully!')\n      onSave()\n    } else {\n      const errorText = await res.text()\n      setMessage(`Failed to update gift: ${errorText}`)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center\">\n      <div className=\"bg-white p-8 rounded-lg shadow-xl max-w-md w-full\">\n        <h2 className=\"text-2xl font-bold mb-4\">Edit Gift</h2>\n        {message && <p className=\"text-red-500 mb-4\">{message}</p>}\n        <form onSubmit={handleSave} className=\"space-y-4\">\n          <div>\n            <label htmlFor=\"gift-description\" className=\"block text-sm font-medium text-gray-300\">Gift Description</label>\n            <input\n              type=\"text\"\n              id=\"gift-description\"\n              className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              value={newDescription}\n              onChange={(e) => setNewDescription(e.target.value)}\n              required\n            />\n          </div>\n          <div>\n            <label htmlFor=\"product-url\" className=\"block text-sm font-medium text-gray-300\">\n              Product URL (Optional)\n            </label>\n            <input\n              type=\"url\"\n              id=\"product-url\"\n              placeholder=\"e.g., https://example.com/product\"\n              className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              value={newProductUrl}\n              onChange={(e) => {\n                setNewProductUrl(e.target.value)\n                debouncedFetchMetadata(e.target.value)\n              }}\n              onBlur={(e) => fetchMetadata(e.target.value)}\n            />\n            {isFetchingMetadata && <p className=\"text-sm text-gray-500 mt-1\">Fetching product details...</p>}\n            {fetchedProductTitle && (\n              <div className=\"mt-2 p-2 border border-gray-200 dark:border-gray-700 rounded-md flex items-center space-x-3\">\n                {fetchedProductImageUrl && (\n                  // eslint-disable-next-line @next/next/no-img-element\n                  <img src={fetchedProductImageUrl} alt={fetchedProductTitle} className=\"w-16 h-16 object-cover rounded-md\" />\n                )}\n                <div>\n                  <p className=\"font-semibold text-gray-700 dark:text-gray-200\">{fetchedProductTitle}</p>\n                  {fetchedProductPrice && <p className=\"text-sm text-gray-600 dark:text-gray-300\">${fetchedProductPrice}</p>}\n                </div>\n              </div>\n            )}\n          </div>\n          <div>\n            <label htmlFor=\"gift-notes\" className=\"block text-sm font-medium text-gray-300\">Notes (Optional)</label>\n            <textarea\n              id=\"gift-notes\"\n              placeholder=\"e.g., Size M, color blue, link to product\"\n              rows={3}\n              className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              value={newNotes}\n              onChange={(e) => setNewNotes(e.target.value)}\n            />\n          </div>\n          <div>\n            <label htmlFor=\"gift-price\" className=\"block text-sm font-medium text-gray-300\">Price (Optional)</label>\n            <input\n              type=\"number\"\n              id=\"gift-price\"\n              placeholder=\"e.g., 25.99\"\n              step=\"0.01\"\n              className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              value={newPrice}\n              onChange={(e) => setNewPrice(e.target.value)}\n            />\n          </div>\n          <div className=\"flex justify-end space-x-2\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              className=\"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              Save Changes\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1079, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/FamilyListClient.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { DragDropContext, Droppable, Draggable, DropResult } from '@hello-pangea/dnd'\nimport Link from 'next/link'\nimport AddGiftForm from './AddGiftForm'\nimport ClaimUnclaimButtons from './ClaimUnclaimButtons'\nimport AddMemberForm from './AddMemberForm'\nimport EditGiftForm from './EditGiftForm' // New component for editing gifts\nimport QRCode from 'react-qr-code'\nimport { User } from '@supabase/supabase-js'\n\ninterface Gift {\n  id: string;\n  description: string;\n  is_purchased: boolean;\n  purchased_by?: string;\n  user_id: string;\n  order_index?: number;\n  notes?: string; // Add notes\n  price?: number; // Add price\n  product_url?: string;\n  product_title?: string;\n  product_image_url?: string;\n  product_price?: number;\n}\n\ninterface Member {\n  id: string;\n  name: string;\n  gifts: Gift[];\n}\n\ninterface Family {\n  id: string;\n  name: string;\n  owner_id: string;\n  members: Member[];\n}\n\n// Utility function to format notes with clickable links\nconst formatNotesWithLinks = (notes?: string) => {\n  if (!notes) return null;\n  const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n  return notes.split(urlRegex).map((part, index) => {\n    if (part.match(urlRegex)) {\n      return (\n        <a key={index} href={part} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-500 hover:underline\">\n          {part}\n        </a>\n      );\n    }\n    return part;\n  });\n};\n\nexport default function FamilyListClient({ initialFamily, initialUser, familyId }: { initialFamily: Family, initialUser: User | null, familyId: string }) {\n  const [family, setFamily] = useState<Family>(initialFamily)\n  const [user, setUser] = useState<User | null>(initialUser)\n  const [editingGift, setEditingGift] = useState<Gift | null>(null)\n  const [expandedGiftId, setExpandedGiftId] = useState<string | null>(null); // State for expanded gift\n  const [sortKey, setSortKey] = useState<keyof Gift | 'order_index'>('order_index'); // Default sort by order_index\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc'); // Default sort order ascending\n  const [showQrModal, setShowQrModal] = useState(false)\n  const [inviteToken, setInviteToken] = useState<string | null>(null)\n  const router = useRouter()\n\n  const handleDragEnd = async (result: DropResult) => {\n    if (!result.destination) return\n\n    const sourceMemberIndex = family.members.findIndex(m => m.id === result.source.droppableId)\n    const destinationMemberIndex = family.members.findIndex(m => m.id === result.destination?.droppableId)\n\n    if (sourceMemberIndex === -1 || destinationMemberIndex === -1) return\n\n    const newFamily = { ...family }\n    const sourceMember = { ...newFamily.members[sourceMemberIndex] }\n    const destinationMember = { ...newFamily.members[destinationMemberIndex] }\n\n    const [removed] = sourceMember.gifts.splice(result.source.index, 1)\n    destinationMember.gifts.splice(result.destination.index, 0, removed)\n\n    // Re-index gifts in both source and destination members\n    sourceMember.gifts = sourceMember.gifts.map((gift, index) => ({ ...gift, order_index: index }));\n    destinationMember.gifts = destinationMember.gifts.map((gift, index) => ({ ...gift, order_index: index }));\n\n    // Optimistically update UI\n    newFamily.members[sourceMemberIndex] = sourceMember\n    newFamily.members[destinationMemberIndex] = destinationMember\n    setFamily(newFamily)\n\n    // Collect all gifts from the entire family structure that need their order_index updated\n    const giftsToUpdate = newFamily.members.flatMap(member =>\n      member.gifts.map(gift => ({\n        id: gift.id,\n        order_index: gift.order_index,\n        list_id: family.id, // Include list_id\n      }))\n    );\n\n    // Call API to update order\n    const res = await fetch('/api/gifts/reorder', {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ items: giftsToUpdate }),\n    })\n\n    if (!res.ok) {\n      const errorText = await res.text()\n      alert(`Failed to reorder gifts: ${errorText}`)\n      router.refresh() // Revert UI on failure\n    }\n  }\n\n  const handleDeleteGift = async (giftId: string) => {\n    if (!confirm('Are you sure you want to delete this gift?')) return\n\n    const res = await fetch(`/api/gifts/${giftId}`, {\n      method: 'DELETE',\n    })\n\n    if (res.ok) {\n      router.refresh()\n    } else {\n      const errorText = await res.text()\n      alert(`Failed to delete gift: ${errorText}`)\n    }\n  }\n\n  const handleToggleExpand = (giftId: string) => {\n    setExpandedGiftId(expandedGiftId === giftId ? null : giftId);\n  };\n\n  const handleSort = (key: keyof Gift | 'order_index') => {\n    if (sortKey === key) {\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortKey(key);\n      setSortOrder('asc');\n    }\n  };\n\n  const handleRemoveMember = async (memberId: string) => {\n    if (!confirm('Are you sure you want to remove this member? This will delete all of their gifts from the list.')) return\n\n    console.log(`Removing member ${memberId} from family ${family.id}`)\n\n    const res = await fetch(`/api/lists/${family.id}/members/${memberId}`, {\n      method: 'DELETE',\n    })\n\n    if (res.ok) {\n      router.refresh()\n    } else {\n      const errorText = await res.text()\n      alert(`Failed to remove member: ${errorText}`)\n    }\n  }\n\n  const generateInvite = async () => {\n    const res = await fetch(`/api/lists/${familyId}/invites`, {\n      method: 'POST',\n    })\n\n    if (res.ok) {\n      const { token } = await res.json()\n      setInviteToken(token)\n      setShowQrModal(true)\n    } else {\n      const { error } = await res.json()\n      alert(`Failed to generate invite link: ${error}`)\n    }\n  }\n\n  const handleLeaveFamily = async () => {\n    if (!confirm('Are you sure you want to leave this family list? You will lose access to all gifts and members.')) return\n\n    const res = await fetch(`/api/lists/${family.id}/leave`, {\n      method: 'DELETE',\n    })\n\n    if (res.ok) {\n      alert('You have successfully left the family list.')\n      router.push('/') // Redirect to home page\n    } else {\n      const errorText: any = await res.json()\n      alert(`Failed to leave family: ${errorText.error}`)\n    }\n  }\n\n  const sortedGifts = (gifts: Gift[]) => {\n    return [...gifts].sort((a, b) => {\n      let valA: string | number;\n      let valB: string | number;\n\n      if (sortKey === 'order_index') {\n        valA = a.order_index || 0;\n        valB = b.order_index || 0;\n      } else if (sortKey === 'price') {\n        valA = a.price || 0;\n        valB = b.price || 0;\n      } else {\n        valA = a[sortKey]?.toString().toLowerCase() || '';\n        valB = b[sortKey]?.toString().toLowerCase() || '';\n      }\n\n      if (valA < valB) return sortOrder === 'asc' ? -1 : 1;\n      if (valA > valB) return sortOrder === 'asc' ? 1 : -1;\n      return 0;\n    });\n  };\n\n  return (\n    <div className=\"px-4 py-8 mx-auto fresh-gradient min-h-screen\">\n      <div className=\"max-w-screen-lg mx-auto\">\n        <h1 className=\"text-4xl font-bold mb-4\">{family.name} Christmas List</h1>\n        <Link href=\"/\" className=\"text-blue-500 hover:underline mb-4 block\">‚Üê Back to Home</Link>\n\n        <div className=\"mb-4 flex items-center space-x-2\">\n          <span className=\"text-gray-300\">Sort by:</span>\n          <select\n            className=\"px-3 py-1 border border-gray-300 rounded-md text-sm\"\n            value={sortKey}\n            onChange={(e) => handleSort(e.target.value as keyof Gift | 'order_index')}\n          >\n            <option value=\"order_index\">Default Order</option>\n            <option value=\"description\">Description</option>\n            <option value=\"price\">Price</option>\n          </select>\n          <button\n            onClick={() => setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc')}\n            className=\"px-3 py-1 bg-gray-200 rounded-md text-sm\"\n          >\n            {sortOrder === 'asc' ? 'Asc' : 'Desc'}\n          </button>\n        </div>\n\n        {family.members.map((member) => (\n          <div key={member.id} className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md mb-8\">\n            <div className=\"flex justify-between items-center\">\n              <h2 className=\"text-2xl font-semibold mb-4\">{member.name}&apos;s List</h2>\n              {user && user.id === family.owner_id && user.id !== member.id && (\n                <button\n                  onClick={() => handleRemoveMember(member.id)}\n                  className=\"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 text-xs\"\n                >\n                  Remove\n                </button>\n              )}\n            </div>\n            {member.gifts.length === 0 ? (\n              <p>No gifts on {member.name}'s list yet.</p>\n            ) : (\n              <DragDropContext onDragEnd={handleDragEnd}>\n                <Droppable droppableId={member.id}>\n                  {(provided) => (\n                    <ul\n                      className=\"list-disc pl-5 space-y-2\"\n                      {...provided.droppableProps}\n                      ref={provided.innerRef}\n                    >\n                      {sortedGifts(member.gifts).map((gift, index) => (\n                        <Draggable key={gift.id} draggableId={gift.id} index={index}>\n                          {(provided) => (\n                            <li\n                              ref={provided.innerRef}\n                              {...provided.draggableProps}\n                              className=\"flex flex-col justify-between items-start bg-gray-50 dark:bg-gray-700 p-2 rounded-md shadow-sm\"\n                            >\n                              <div\n                                className=\"flex justify-between w-full items-center\"\n                                {...provided.dragHandleProps} // Apply drag handle props here\n                              >\n                                <span\n                                  className=\"cursor-pointer flex-grow\"\n                                  onClick={() => handleToggleExpand(gift.id)}\n                                >\n                                  {gift.description}\n                                  {gift.is_purchased && user.id !== gift.user_id && (\n                                    <span className=\"ml-2 text-sm text-green-600\">\n                                      (Claimed by {family.members.find(m => m.id === gift.purchased_by)?.name})\n                                    </span>\n                                  )}\n                                </span>\n                                <div className=\"flex items-center space-x-2\">\n                                  {user && user.id === gift.user_id && ( // Only owner can edit/delete\n                                    <>\n                                      <button\n                                        onClick={(e) => { e.stopPropagation(); setEditingGift(gift); }}\n                                        className=\"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-xs\"\n                                      >\n                                        Edit\n                                      </button>\n                                      <button\n                                        onClick={(e) => { e.stopPropagation(); handleDeleteGift(gift.id); }}\n                                        className=\"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 text-xs\"\n                                      >\n                                        Delete\n                                      </button>\n                                    </>\n                                  )}\n                                  {user && user.id !== gift.user_id && (\n                                    <ClaimUnclaimButtons\n                                      gift={gift}\n                                      userId={user.id}\n                                    />\n                                  )}\n                                </div>\n                              </div>\n                              {expandedGiftId === gift.id && (\n                                <div className=\"mt-2 text-sm text-gray-300 w-full\">\n                                  {gift.product_image_url && (\n                                    // eslint-disable-next-line @next/next/no-img-element\n                                    <img src={gift.product_image_url} alt={gift.product_title || gift.description} className=\"w-24 h-24 object-cover rounded-md mb-2\" />\n                                  )}\n                                  {gift.product_title && gift.product_url ? (\n                                    <p>\n                                      <strong>Product:</strong>{' '}\n                                      <a href={gift.product_url} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-400 hover:underline\">\n                                        {gift.product_title}\n                                      </a>\n                                    </p>\n                                  ) : gift.product_title && (\n                                    <p><strong>Product:</strong> {gift.product_title}</p>\n                                  )}\n                                  {gift.notes && (\n                                    <p><strong>Notes:</strong> {formatNotesWithLinks(gift.notes)}</p>\n                                  )}\n                                  {gift.price && (\n                                    <p><strong>Price:</strong> ${gift.price.toFixed(2)}</p>\n                                  )}\n                                </div>\n                              )}\n                            </li>\n                          )}\n                        </Draggable>\n                      ))}\n                      {provided.placeholder}\n                    </ul>\n                  )}\n                </Droppable>\n              </DragDropContext>\n            )}\n          </div>\n        ))}\n\n        {user && (\n          <AddGiftForm\n            familyId={family.id}\n            currentUserId={user.id}\n            members={family.members}\n          />\n        )}\n\n        <div className=\"mt-8\">\n          <button\n            onClick={generateInvite}\n            className=\"w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600\"\n          >\n            Invite with QR Code\n          </button>\n        </div>\n\n        {user && user.id === family.owner_id && (\n          <AddMemberForm\n            familyId={family.id}\n            currentUserId={user.id}\n            members={family.members}\n          />\n        )}\n\n        {user && user.id !== family.owner_id && (\n          <div className=\"mt-4\">\n            <button\n              onClick={handleLeaveFamily}\n              className=\"w-full bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600\"\n            >\n              Leave Family List\n            </button>\n          </div>\n        )}\n\n        {editingGift && (\n          <EditGiftForm\n            gift={editingGift}\n            onClose={() => setEditingGift(null)}\n            onSave={() => {\n              setEditingGift(null)\n              router.refresh()\n            }}\n          />\n        )}\n\n        {showQrModal && inviteToken && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center\">\n            <div className=\"bg-white p-8 rounded-lg shadow-lg text-center\">\n              <h2 className=\"text-2xl font-bold mb-4\">Scan to Join!</h2>\n              <QRCode value={`${window.location.origin}/invite?token=${inviteToken}`} />\n              <button\n                onClick={() => setShowQrModal(false)}\n                className=\"mt-4 px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600\"\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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","debugId":null}}]
}