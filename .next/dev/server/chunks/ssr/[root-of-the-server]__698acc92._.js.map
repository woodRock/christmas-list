{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 18, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/FamilyListClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/list/[familyId]/FamilyListClient.tsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/list/[familyId]/FamilyListClient.tsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAAgT,GAC7U,8EACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 32, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/FamilyListClient.tsx/__nextjs-internal-proxy.mjs"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/src/app/list/[familyId]/FamilyListClient.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/src/app/list/[familyId]/FamilyListClient.tsx\",\n    \"default\",\n);\n"],"names":[],"mappings":"AAAA,uEAAuE;;;;;AACvE;;uCACe,IAAA,wQAAuB,EAClC;IAAa,MAAM,IAAI,MAAM;AAA4R,GACzT,0DACA","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 54, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/page.tsx"],"sourcesContent":["import { createClient } from '@/lib/supabase-server'\nimport { redirect } from 'next/navigation'\nimport FamilyListClient from './FamilyListClient' // Client component for the list\n\ninterface Gift {\n  id: string;\n  description: string;\n  is_purchased: boolean;\n  purchased_by?: string;\n  user_id: string;\n  order_index?: number; // Add order_index\n  notes?: string; // Add notes\n  price?: number; // Add price\n}\n\ninterface Member {\n  id: string;\n  name: string;\n  gifts: Gift[];\n}\n\ninterface Family {\n  id: string;\n  name: string;\n  owner_id: string;\n  members: Member[];\n}\n\nexport default async function FamilyListPage({ params }: { params: { familyId: string } }) {\n  const resolvedParams = await Promise.resolve(params); // Ensure params are resolved\n  const supabase = await createClient()\n  const { data: { user } } = await supabase.auth.getUser()\n\n  if (!user) {\n    redirect('/login')\n  }\n\n  const { data: listData, error: listError } = await supabase\n    .from('lists')\n    .select('id, name, user_id, list_members(profile_id, profiles(full_name))')\n    .eq('id', resolvedParams.familyId)\n    .single()\n  console.log(\"listData:\", listData);\n\n  if (listError) {\n    return <p className=\"text-red-500 text-center\">Error loading family list: {listError.message}</p>\n  }\n\n  if (!listData) {\n    return <p className=\"text-center text-gray-600\">Family list not found.</p>\n  }\n\n  const isOwner = listData.user_id === user.id;\n  const isMember = listData.list_members.some((member: any) => member.profile_id === user.id);\n\n  if (!isOwner && !isMember) {\n    redirect('/')\n  }\n\n  const { data: itemsData, error: itemsError } = await supabase\n    .from('items')\n    .select('id, name, is_purchased, purchased_by, user_id, order_index, notes, price') // Select order_index, notes, price\n    .eq('list_id', resolvedParams.familyId)\n\n  if (itemsError) {\n    return <p className=\"text-red-500 text-center\">Error loading gifts: {itemsError.message}</p>\n  }\n\n  const profileIds = new Set<string>();\n  itemsData.forEach(item => {\n    profileIds.add(item.user_id); // Recipient\n    if (item.purchased_by) {\n      profileIds.add(item.purchased_by); // Purchaser\n    }\n  });\n  profileIds.add(listData.user_id); // List owner\n\n  // Extract profiles from list_members\n  listData.list_members.forEach((lm: any) => {\n    profileIds.add(lm.profile_id);\n  });\n  console.log(\"profileIds after collecting from items, owner, and list_members:\", profileIds);\n\n  const { data: profilesData, error: profilesError } = await supabase\n    .from('profiles')\n    .select('id, full_name')\n    .in('id', Array.from(profileIds));\n  console.log(\"profilesData after fetching:\", profilesData);\n\n  if (profilesError) {\n    return <p className=\"text-red-500 text-center\">Error loading profiles: {profilesError.message}</p>\n  }\n\n  const membersMap = new Map<string, Member>();\n  profilesData.forEach(profile => {\n    membersMap.set(profile.id, {\n      id: profile.id,\n      name: profile.full_name,\n      gifts: [],\n    });\n  });\n  console.log(\"membersMap after populating:\", membersMap);\n\n  itemsData.forEach(item => {\n    const recipientMember = membersMap.get(item.user_id);\n    if (recipientMember) {\n      recipientMember.gifts.push({\n        id: item.id,\n        description: item.name,\n        is_purchased: item.is_purchased,\n        purchased_by: item.purchased_by || undefined,\n        user_id: item.user_id,\n        order_index: item.order_index || 0, // Assign order_index\n        notes: item.notes || undefined,\n        price: item.price || undefined,\n      });\n    }\n  });\n\n  const family: Family = {\n    id: listData.id,\n    name: listData.name,\n    owner_id: listData.user_id,\n    members: Array.from(membersMap.values()),\n  };\n\n  console.log(\"Current User ID:\", user.id);\n  console.log(\"Family Members:\", family.members);\n\n  return (\n    <FamilyListClient initialFamily={family} initialUser={user} familyId={resolvedParams.familyId} />\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}