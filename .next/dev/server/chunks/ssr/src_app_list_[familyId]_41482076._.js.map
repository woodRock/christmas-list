{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/AddGiftForm.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useCallback } from 'react'\nimport { createClient } from '@/lib/supabase'\nimport { useRouter } from 'next/navigation'\n\ninterface Member {\n  id: string;\n  name: string;\n}\n\ninterface AddGiftFormProps {\n  familyId: string;\n  currentUserId: string;\n  members: Member[];\n}\n\n// Debounce function defined outside the component to be stable\nconst debounce = <T extends (...args: any[]) => any>(func: T, delay: number): ((...args: Parameters<T>) => void) => {\n  let timeout: NodeJS.Timeout | null = null\n  return (...args: Parameters<T>) => {\n    if (timeout) {\n      clearTimeout(timeout)\n    }\n    timeout = setTimeout(() => {\n      func(...args)\n    }, delay)\n  }\n}\n\nexport default function AddGiftForm({ familyId, currentUserId, members }: AddGiftFormProps) {\n  const [newGiftDescription, setNewGiftDescription] = useState('')\n  const [newGiftNotes, setNewGiftNotes] = useState('')\n  const [newGiftPrice, setNewGiftPrice] = useState<string>('')\n  const [newProductUrl, setNewProductUrl] = useState('')\n  const [fetchedProductTitle, setFetchedProductTitle] = useState('')\n  const [fetchedProductImageUrl, setFetchedProductImageUrl] = useState('')\n  const [fetchedProductPrice, setFetchedProductPrice] = useState<string>('')\n  const [isFetchingMetadata, setIsFetchingMetadata] = useState(false)\n  const [selectedRecipientId, setSelectedRecipientId] = useState(currentUserId) // Default to current user\n  const [message, setMessage] = useState('')\n  const supabase = createClient()\n  const router = useRouter()\n\n  const fetchMetadata = useCallback(async (url: string) => {\n    if (!url || !url.startsWith('http')) {\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n      return\n    }\n\n    setIsFetchingMetadata(true)\n    try {\n      const res = await fetch('/api/gifts/fetch-metadata', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ url }),\n      })\n      const data = await res.json()\n\n      if (res.ok) {\n        setFetchedProductTitle(data.title || '')\n        setFetchedProductImageUrl(data.imageUrl || '')\n        setFetchedProductPrice(data.price ? data.price.toFixed(2) : '')\n        // If price is fetched, pre-fill the gift price field\n        if (data.price) setNewGiftPrice(data.price.toFixed(2))\n      } else {\n        setMessage(`Failed to fetch metadata: ${data.error}`)\n        setFetchedProductTitle('')\n        setFetchedProductImageUrl('')\n        setFetchedProductPrice('')\n      }\n    } catch (error: unknown) {\n      let errorMessage = 'Error fetching metadata';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      } else if (typeof error === 'string') {\n        errorMessage = error;\n      }\n      setMessage(`Error fetching metadata: ${errorMessage}`)\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n    } finally {\n      setIsFetchingMetadata(false)\n    }\n  }, [])\n\n  const debouncedFetchMetadata = useCallback(debounce(fetchMetadata, 700), [fetchMetadata])\n\n  const handleAddGift = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setMessage('')\n\n    if (!newGiftDescription && !fetchedProductTitle) {\n      setMessage('Gift description or fetched product title is required.')\n      return\n    }\n\n    if (!selectedRecipientId) {\n      setMessage('Please select a recipient.')\n      return\n    }\n\n    // Get the current max order_index for the list\n    const { data: maxOrderData, error: _maxOrderError } = await supabase\n      .from('items')\n      .select('order_index')\n      .eq('list_id', familyId)\n      .order('order_index', { ascending: false })\n      .limit(1)\n      .single()\n\n    const nextOrderIndex = maxOrderData ? maxOrderData.order_index + 1 : 0;\n\n    const { error } = await supabase\n      .from('items')\n      .insert([{\n        list_id: familyId,\n        user_id: selectedRecipientId,\n        name: newGiftDescription || fetchedProductTitle, // Use fetched title if description is empty\n        notes: newGiftNotes || null,\n        price: newGiftPrice ? parseFloat(newGiftPrice) : (fetchedProductPrice ? parseFloat(fetchedProductPrice) : null),\n        order_index: nextOrderIndex,\n        product_url: newProductUrl || null,\n        product_title: fetchedProductTitle || null,\n        product_image_url: fetchedProductImageUrl || null,\n        product_price: fetchedProductPrice ? parseFloat(fetchedProductPrice) : null,\n      }])\n\n    if (error) {\n      setMessage(`Failed to add gift: ${error.message}`)\n    } else {\n      setMessage(`Gift \"${newGiftDescription || fetchedProductTitle}\" added successfully!`)\n      setNewGiftDescription('')\n      setNewGiftNotes('')\n      setNewGiftPrice('')\n      setNewProductUrl('')\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n      router.refresh() // Refresh the current page to show the new gift\n    }\n  }\n\n  return (\n    <div className=\"mt-6 pt-4 border-t border-gray-200 bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md\">\n      <h3 className=\"text-xl font-semibold mb-3\">Add a Gift</h3>\n      {message && <p className=\"text-red-500 mb-3\">{message}</p>}\n      <form onSubmit={handleAddGift} className=\"space-y-3\">\n        <div>\n          <label htmlFor=\"recipient\" className=\"block text-sm font-medium text-gray-300\">Recipient</label>\n          <select\n            id=\"recipient\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={selectedRecipientId}\n            onChange={(e) => setSelectedRecipientId(e.target.value)}\n            required\n          >\n            {members.map((member) => (\n              <option key={member.id} value={member.id}>\n                {member.name} {member.id === currentUserId ? '(You)' : ''}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div>\n          <label htmlFor=\"product-url\" className=\"block text-sm font-medium text-gray-300\">\n            Product URL (Optional)\n          </label>\n          <input\n            type=\"url\"\n            id=\"product-url\"\n            placeholder=\"e.g., https://example.com/product\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newProductUrl}\n            onChange={(e) => {\n              setNewProductUrl(e.target.value)\n              debouncedFetchMetadata(e.target.value)\n            }}\n            onBlur={(e) => fetchMetadata(e.target.value)}\n          />\n          {isFetchingMetadata && <p className=\"text-sm text-gray-500 mt-1\">Fetching product details...</p>}\n          {fetchedProductTitle && (\n            <div className=\"mt-2 p-2 border border-gray-200 dark:border-gray-700 rounded-md flex items-center space-x-3\">\n              {fetchedProductImageUrl && (\n                // eslint-disable-next-line @next/next/no-img-element\n                <img src={fetchedProductImageUrl} alt={fetchedProductTitle} className=\"w-16 h-16 object-cover rounded-md\" />\n              )}\n              <div>\n                <p className=\"font-semibold text-gray-700 dark:text-gray-200\">{fetchedProductTitle}</p>\n                {fetchedProductPrice && <p className=\"text-sm text-gray-600 dark:text-gray-300\">${fetchedProductPrice}</p>}\n              </div>\n            </div>\n          )}\n        </div>\n        <div>\n          <label htmlFor=\"gift-desc\" className=\"block text-sm font-medium text-gray-300\">\n            Gift Description (or use fetched title)\n          </label>\n          <input\n            type=\"text\"\n            id=\"gift-desc\"\n            placeholder=\"Gift description\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newGiftDescription}\n            onChange={(e) => setNewGiftDescription(e.target.value)}\n            required={!fetchedProductTitle} // Required only if no title is fetched\n          />\n        </div>\n        <div>\n          <label htmlFor=\"gift-notes\" className=\"block text-sm font-medium text-gray-300\">\n            Notes (Optional)\n          </label>\n          <textarea\n            id=\"gift-notes\"\n            placeholder=\"e.g., Size M, color blue, link to product\"\n            rows={3}\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newGiftNotes}\n            onChange={(e) => setNewGiftNotes(e.target.value)}\n          />\n        </div>\n        <div>\n          <label htmlFor=\"gift-price\" className=\"block text-sm font-medium text-gray-300\">\n            Price (Optional)\n          </label>\n          <input\n            type=\"number\"\n            id=\"gift-price\"\n            placeholder=\"e.g., 25.99\"\n            step=\"0.01\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newGiftPrice}\n            onChange={(e) => setNewGiftPrice(e.target.value)}\n          />\n        </div>\n        <button\n          type=\"submit\"\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm\"\n        >\n          Add Gift\n        </button>\n      </form>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 401, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/ClaimUnclaimButtons.tsx"],"sourcesContent":["'use client'\n\nimport { useRouter } from 'next/navigation'\nimport { useState } from 'react'\n\ninterface Gift {\n  id: string;\n  description: string;\n  is_purchased: boolean;\n  purchased_by?: string;\n  user_id: string;\n}\n\ninterface ClaimUnclaimButtonsProps {\n  gift: Gift;\n  userId: string;\n}\n\nexport default function ClaimUnclaimButtons({ gift, userId }: ClaimUnclaimButtonsProps) {\n  const [message, setMessage] = useState('')\n  const router = useRouter()\n\n  const handleClaimGift = async () => {\n    setMessage('')\n    const res = await fetch(`/api/gifts/${gift.id}/claim`, {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ claimedByUserId: userId }),\n    })\n\n    if (res.ok) {\n      setMessage('Gift claimed successfully!')\n      router.refresh()\n    } else {\n      const errorText = await res.text()\n      setMessage(`Failed to claim gift: ${errorText}`)\n    }\n  }\n\n  const handleUnclaimGift = async () => {\n    setMessage('')\n    const res = await fetch(`/api/gifts/${gift.id}/unclaim`, {\n      method: 'PATCH', // Changed to PATCH as per API route\n      headers: { 'Content-Type': 'application/json' },\n    })\n\n    if (res.ok) {\n      setMessage('Gift unclaimed successfully!')\n      router.refresh()\n    } else {\n      const errorText = await res.text()\n      setMessage(`Failed to unclaim gift: ${errorText}`)\n    }\n  }\n\n  return (\n    <div>\n      {message && <p className=\"text-red-500 text-sm mb-2\">{message}</p>}\n      {!gift.is_purchased && (\n        <button\n          onClick={handleClaimGift}\n          className=\"ml-4 px-3 py-1 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm\"\n        >\n          Claim\n        </button>\n      )}\n      {gift.is_purchased && gift.purchased_by === userId && (\n        <button\n          onClick={handleUnclaimGift}\n          className=\"ml-4 px-3 py-1 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 text-sm\"\n        >\n          Unclaim\n        </button>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAkBe,SAAS,oBAAoB,EAAE,IAAI,EAAE,MAAM,EAA4B;IACpF,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,SAAS,IAAA,+IAAS;IAExB,MAAM,kBAAkB;QACtB,WAAW;QACX,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,KAAK,EAAE,CAAC,MAAM,CAAC,EAAE;YACrD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,iBAAiB;YAAO;QACjD;QAEA,IAAI,IAAI,EAAE,EAAE;YACV,WAAW;YACX,OAAO,OAAO;QAChB,OAAO;YACL,MAAM,YAAY,MAAM,IAAI,IAAI;YAChC,WAAW,CAAC,sBAAsB,EAAE,WAAW;QACjD;IACF;IAEA,MAAM,oBAAoB;QACxB,WAAW;QACX,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE;YACvD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAChD;QAEA,IAAI,IAAI,EAAE,EAAE;YACV,WAAW;YACX,OAAO,OAAO;QAChB,OAAO;YACL,MAAM,YAAY,MAAM,IAAI,IAAI;YAChC,WAAW,CAAC,wBAAwB,EAAE,WAAW;QACnD;IACF;IAEA,qBACE,8OAAC;;YACE,yBAAW,8OAAC;gBAAE,WAAU;0BAA6B;;;;;;YACrD,CAAC,KAAK,YAAY,kBACjB,8OAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;YAIF,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK,wBAC1C,8OAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;;;;;;;AAMT","debugId":null}},
    {"offset": {"line": 489, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/AddMemberForm.tsx"],"sourcesContent":["import { createClient } from '@/lib/supabase'\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\n\ninterface AddMemberFormProps {\n  familyId: string;\n  currentUserId: string;\n  members: { id: string; name: string }[];\n}\n\nexport default function AddMemberForm({ familyId, currentUserId, members }: AddMemberFormProps) {\n  const [newMemberName, setNewMemberName] = useState('')\n  const [newMemberEmail, setNewMemberEmail] = useState('') // Assuming email for finding user ID\n  const [message, setMessage] = useState('')\n  const supabase = createClient()\n  const router = useRouter()\n\n  const handleAddMember = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setMessage('')\n\n    console.log(\"Attempting to add member:\", { newMemberName, newMemberEmail, familyId, currentUserId });\n\n    if (!newMemberName || !newMemberEmail) {\n      setMessage('Member name and email are required.')\n      return\n    }\n\n    // First, check if the current user is part of this family list\n    const isCurrentUserMember = members.some(member => member.id === currentUserId);\n    if (!isCurrentUserMember) {\n      setMessage('You must be a member of this list to add new members.');\n      return;\n    }\n\n    try {\n      const res = await fetch(`/api/lists/${familyId}/members`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ memberName: newMemberName, memberEmail: newMemberEmail }),\n      });\n\n      console.log(\"API response status:\", res.status);\n      const data = await res.json();\n      console.log(\"API response data:\", data);\n\n      if (res.ok) {\n        setMessage(data.message);\n        setNewMemberName('');\n        setNewMemberEmail('');\n        router.refresh(); // Refresh the page to show the new member in the dropdowns\n      } else {\n        setMessage(`Failed to add member: ${data.error}`);\n      }\n    } catch (error: unknown) {\n      let errorMessage = 'Error adding member';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      } else if (typeof error === 'string') {\n        errorMessage = error;\n      }\n      setMessage(`Error adding member: ${errorMessage}`);\n      console.error(\"Error during add member fetch:\", error);\n    }\n  }\n\n  return (\n    <div className=\"mt-8 p-6 bg-white dark:bg-gray-800 rounded-lg shadow-md\">\n      <h3 className=\"text-2xl font-semibold mb-4\">Add New Family Member</h3>\n      {message && <p className=\"text-red-500 mb-4\">{message}</p>}\n      <form onSubmit={handleAddMember} className=\"space-y-4\">\n        <div>\n          <label htmlFor=\"newMemberName\" className=\"block text-sm font-medium text-gray-300\">Member Name</label>\n          <input\n            type=\"text\"\n            id=\"newMemberName\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newMemberName}\n            onChange={(e) => setNewMemberName(e.target.value)}\n            required\n          />\n        </div>\n        <div>\n          <label htmlFor=\"newMemberEmail\" className=\"block text-sm font-medium text-gray-300\">Member Email</label>\n          <input\n            type=\"email\"\n            id=\"newMemberEmail\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newMemberEmail}\n            onChange={(e) => setNewMemberEmail(e.target.value)}\n            required\n          />\n        </div>\n        <button\n          type=\"submit\"\n          className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm\"\n        >\n          Add Member\n        </button>\n      </form>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;;;;;AAQe,SAAS,cAAc,EAAE,QAAQ,EAAE,aAAa,EAAE,OAAO,EAAsB;IAC5F,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAC;IACnD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAC,IAAI,qCAAqC;;IAC9F,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,WAAW,IAAA,sIAAY;IAC7B,MAAM,SAAS,IAAA,+IAAS;IAExB,MAAM,kBAAkB,OAAO;QAC7B,EAAE,cAAc;QAChB,WAAW;QAEX,QAAQ,GAAG,CAAC,6BAA6B;YAAE;YAAe;YAAgB;YAAU;QAAc;QAElG,IAAI,CAAC,iBAAiB,CAAC,gBAAgB;YACrC,WAAW;YACX;QACF;QAEA,+DAA+D;QAC/D,MAAM,sBAAsB,QAAQ,IAAI,CAAC,CAAA,SAAU,OAAO,EAAE,KAAK;QACjE,IAAI,CAAC,qBAAqB;YACxB,WAAW;YACX;QACF;QAEA,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,SAAS,QAAQ,CAAC,EAAE;gBACxD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,YAAY;oBAAe,aAAa;gBAAe;YAChF;YAEA,QAAQ,GAAG,CAAC,wBAAwB,IAAI,MAAM;YAC9C,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,QAAQ,GAAG,CAAC,sBAAsB;YAElC,IAAI,IAAI,EAAE,EAAE;gBACV,WAAW,KAAK,OAAO;gBACvB,iBAAiB;gBACjB,kBAAkB;gBAClB,OAAO,OAAO,IAAI,2DAA2D;YAC/E,OAAO;gBACL,WAAW,CAAC,sBAAsB,EAAE,KAAK,KAAK,EAAE;YAClD;QACF,EAAE,OAAO,OAAgB;YACvB,IAAI,eAAe;YACnB,IAAI,iBAAiB,OAAO;gBAC1B,eAAe,MAAM,OAAO;YAC9B,OAAO,IAAI,OAAO,UAAU,UAAU;gBACpC,eAAe;YACjB;YACA,WAAW,CAAC,qBAAqB,EAAE,cAAc;YACjD,QAAQ,KAAK,CAAC,kCAAkC;QAClD;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAA8B;;;;;;YAC3C,yBAAW,8OAAC;gBAAE,WAAU;0BAAqB;;;;;;0BAC9C,8OAAC;gBAAK,UAAU;gBAAiB,WAAU;;kCACzC,8OAAC;;0CACC,8OAAC;gCAAM,SAAQ;gCAAgB,WAAU;0CAA0C;;;;;;0CACnF,8OAAC;gCACC,MAAK;gCACL,IAAG;gCACH,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;gCAChD,QAAQ;;;;;;;;;;;;kCAGZ,8OAAC;;0CACC,8OAAC;gCAAM,SAAQ;gCAAiB,WAAU;0CAA0C;;;;;;0CACpF,8OAAC;gCACC,MAAK;gCACL,IAAG;gCACH,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,kBAAkB,EAAE,MAAM,CAAC,KAAK;gCACjD,QAAQ;;;;;;;;;;;;kCAGZ,8OAAC;wBACC,MAAK;wBACL,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT","debugId":null}},
    {"offset": {"line": 667, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/EditGiftForm.tsx"],"sourcesContent":["'use client'\n\nimport { useState, useCallback } from 'react'\n\ninterface Gift {\n  id: string;\n  description: string;\n  notes?: string;\n  price?: number;\n  product_url?: string;\n  product_title?: string;\n  product_image_url?: string;\n  product_price?: number;\n}\n\ninterface EditGiftFormProps {\n  gift: Gift;\n  onClose: () => void;\n  onSave: () => void;\n}\n\nexport default function EditGiftForm({ gift, onClose, onSave }: EditGiftFormProps) {\n  const [newDescription, setNewDescription] = useState(gift.description)\n  const [newNotes, setNewNotes] = useState(gift.notes || '')\n  const [newPrice, setNewPrice] = useState<string>(gift.price?.toString() || '')\n  const [newProductUrl, setNewProductUrl] = useState(gift.product_url || '')\n  const [fetchedProductTitle, setFetchedProductTitle] = useState(gift.product_title || '')\n  const [fetchedProductImageUrl, setFetchedProductImageUrl] = useState(gift.product_image_url || '')\n  const [fetchedProductPrice, setFetchedProductPrice] = useState<string>(gift.product_price?.toString() || '')\n  const [isFetchingMetadata, setIsFetchingMetadata] = useState(false)\n  const [message, setMessage] = useState('')\n\n// Debounce function defined outside the component to be stable\nconst debounce = <T extends (...args: any[]) => any>(func: T, delay: number): ((...args: Parameters<T>) => void) => {\n  let timeout: NodeJS.Timeout | null = null\n  return (...args: Parameters<T>) => {\n    if (timeout) {\n      clearTimeout(timeout)\n    }\n    timeout = setTimeout(() => {\n      func(...args)\n    }, delay)\n  }\n}\n\n  const fetchMetadata = useCallback(async (url: string) => {\n    if (!url || !url.startsWith('http')) {\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n      return\n    }\n\n    setIsFetchingMetadata(true)\n    try {\n      const res = await fetch('/api/gifts/fetch-metadata', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ url }),\n      })\n      const data = await res.json()\n\n      if (res.ok) {\n        setFetchedProductTitle(data.title || '')\n        setFetchedProductImageUrl(data.imageUrl || '')\n        setFetchedProductPrice(data.price ? data.price.toFixed(2) : '')\n        // If price is fetched, pre-fill the gift price field\n        if (data.price) setNewPrice(data.price.toFixed(2))\n      } else {\n        setMessage(`Failed to fetch metadata: ${data.error}`)\n        setFetchedProductTitle('')\n        setFetchedProductImageUrl('')\n        setFetchedProductPrice('')\n      }\n    } catch (error: unknown) {\n      let errorMessage = 'Error fetching metadata';\n      if (error instanceof Error) {\n        errorMessage = error.message;\n      } else if (typeof error === 'string') {\n        errorMessage = error;\n      }\n      setMessage(`Error fetching metadata: ${errorMessage}`)\n      setFetchedProductTitle('')\n      setFetchedProductImageUrl('')\n      setFetchedProductPrice('')\n    } finally {\n      setIsFetchingMetadata(false)\n    }\n  }, [])\n\n  const debouncedFetchMetadata = useCallback(debounce(fetchMetadata, 700), [fetchMetadata])\n\n  const handleSave = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setMessage('')\n\n    if (!newDescription) {\n      setMessage('Gift description cannot be empty.')\n      return\n    }\n\n    const res = await fetch(`/api/gifts/${gift.id}`, {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        description: newDescription,\n        notes: newNotes,\n        price: newPrice ? parseFloat(newPrice) : null,\n        product_url: newProductUrl || null,\n        product_title: fetchedProductTitle || null,\n        product_image_url: fetchedProductImageUrl || null,\n        product_price: fetchedProductPrice ? parseFloat(fetchedProductPrice) : null,\n      }),\n    })\n\n    if (res.ok) {\n      setMessage('Gift updated successfully!')\n      onSave()\n    } else {\n      const errorText = await res.text()\n      setMessage(`Failed to update gift: ${errorText}`)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center\">\n      <div className=\"bg-white p-8 rounded-lg shadow-xl max-w-md w-full\">\n        <h2 className=\"text-2xl font-bold mb-4\">Edit Gift</h2>\n        {message && <p className=\"text-red-500 mb-4\">{message}</p>}\n        <form onSubmit={handleSave} className=\"space-y-4\">\n          <div>\n            <label htmlFor=\"gift-description\" className=\"block text-sm font-medium text-gray-300\">Gift Description</label>\n            <input\n              type=\"text\"\n              id=\"gift-description\"\n              className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              value={newDescription}\n              onChange={(e) => setNewDescription(e.target.value)}\n              required\n            />\n          </div>\n          <div>\n            <label htmlFor=\"product-url\" className=\"block text-sm font-medium text-gray-300\">\n              Product URL (Optional)\n            </label>\n            <input\n              type=\"url\"\n              id=\"product-url\"\n              placeholder=\"e.g., https://example.com/product\"\n              className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              value={newProductUrl}\n              onChange={(e) => {\n                setNewProductUrl(e.target.value)\n                debouncedFetchMetadata(e.target.value)\n              }}\n              onBlur={(e) => fetchMetadata(e.target.value)}\n            />\n            {isFetchingMetadata && <p className=\"text-sm text-gray-500 mt-1\">Fetching product details...</p>}\n            {fetchedProductTitle && (\n              <div className=\"mt-2 p-2 border border-gray-200 dark:border-gray-700 rounded-md flex items-center space-x-3\">\n                {fetchedProductImageUrl && (\n                  // eslint-disable-next-line @next/next/no-img-element\n                  <img src={fetchedProductImageUrl} alt={fetchedProductTitle} className=\"w-16 h-16 object-cover rounded-md\" />\n                )}\n                <div>\n                  <p className=\"font-semibold text-gray-700 dark:text-gray-200\">{fetchedProductTitle}</p>\n                  {fetchedProductPrice && <p className=\"text-sm text-gray-600 dark:text-gray-300\">${fetchedProductPrice}</p>}\n                </div>\n              </div>\n            )}\n          </div>\n          <div>\n            <label htmlFor=\"gift-notes\" className=\"block text-sm font-medium text-gray-300\">Notes (Optional)</label>\n            <textarea\n              id=\"gift-notes\"\n              placeholder=\"e.g., Size M, color blue, link to product\"\n              rows={3}\n              className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              value={newNotes}\n              onChange={(e) => setNewNotes(e.target.value)}\n            />\n          </div>\n          <div>\n            <label htmlFor=\"gift-price\" className=\"block text-sm font-medium text-gray-300\">Price (Optional)</label>\n            <input\n              type=\"number\"\n              id=\"gift-price\"\n              placeholder=\"e.g., 25.99\"\n              step=\"0.01\"\n              className=\"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              value={newPrice}\n              onChange={(e) => setNewPrice(e.target.value)}\n            />\n          </div>\n          <div className=\"flex justify-end space-x-2\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              className=\"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              Save Changes\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1027, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/FamilyListClient.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { DragDropContext, Droppable, Draggable, DropResult } from '@hello-pangea/dnd'\nimport Link from 'next/link'\nimport AddGiftForm from './AddGiftForm'\nimport ClaimUnclaimButtons from './ClaimUnclaimButtons'\nimport AddMemberForm from './AddMemberForm'\nimport EditGiftForm from './EditGiftForm' // New component for editing gifts\nimport QRCode from 'react-qr-code'\nimport { User } from '@supabase/supabase-js'\n\ninterface Gift {\n  id: string;\n  description: string;\n  is_purchased: boolean;\n  purchased_by?: string;\n  user_id: string;\n  order_index?: number;\n  notes?: string; // Add notes\n  price?: number; // Add price\n  product_url?: string;\n  product_title?: string;\n  product_image_url?: string;\n  product_price?: number;\n}\n\ninterface Member {\n  id: string;\n  name: string;\n  gifts: Gift[];\n}\n\ninterface Family {\n  id: string;\n  name: string;\n  owner_id: string;\n  members: Member[];\n}\n\n// Utility function to format notes with clickable links\nconst formatNotesWithLinks = (notes?: string) => {\n  if (!notes) return null;\n  const urlRegex = /(https?:\\/\\/[^\\s]+)/g;\n  return notes.split(urlRegex).map((part, index) => {\n    if (part.match(urlRegex)) {\n      return (\n        <a key={index} href={part} target=\"_blank\" rel=\"noopener noreferrer\" className=\"text-blue-500 hover:underline\">\n          {part}\n        </a>\n      );\n    }\n    return part;\n  });\n};\n\nexport default function FamilyListClient({ initialFamily, initialUser, familyId }: { initialFamily: Family, initialUser: User | null, familyId: string }) {\n  const [family, setFamily] = useState<Family>(initialFamily)\n  const [user] = useState<User | null>(initialUser)\n  const [editingGift, setEditingGift] = useState<Gift | null>(null)\n  const [sortKey, setSortKey] = useState<keyof Gift | 'order_index'>('order_index'); // Default sort by order_index\n  const [sortOrder, setSortOrder] = useState<'asc' | 'desc'>('asc'); // Default sort order ascending\n  const [showQrModal, setShowQrModal] = useState(false)\n  const [inviteToken, setInviteToken] = useState<string | null>(null)\n  const [viewMode, setViewMode] = useState<'list' | 'grid'>('list') // New state for view mode\n  const [isDragging, setIsDragging] = useState(false); // New state to track dragging\n  const router = useRouter()\n\n  const handleDragEnd = async (result: DropResult) => {\n    console.log('handleDragEnd result:', result);\n\n    // Check if dropped into a trash bin\n    if (result.destination && result.destination.droppableId === 'trash-bin') {\n      console.log('Dropped into trash bin:', result.destination.droppableId);\n      handleDeleteGift(result.draggableId);\n      setIsDragging(false); // End dragging after handling delete\n      return;\n    }\n\n    // If dropped outside any droppable (and not a trash bin), delete the item\n    if (!result.destination) {\n      console.log('Dropped outside any droppable. Deleting item:', result.draggableId);\n      handleDeleteGift(result.draggableId);\n      setIsDragging(false); // End dragging if dropped nowhere valid\n      return;\n    }\n\n    console.log('Dropped into a valid droppable (not trash bin):', result.destination.droppableId);\n\n    const sourceMemberIndex = family.members.findIndex(m => m.id === result.source.droppableId)\n    const destinationMemberIndex = family.members.findIndex(m => m.id === result.destination?.droppableId)\n\n    if (sourceMemberIndex === -1 || destinationMemberIndex === -1) {\n      setIsDragging(false); // End dragging if source/destination not found\n      return;\n    }\n\n    const newFamily = { ...family }\n    const sourceMember = { ...newFamily.members[sourceMemberIndex] }\n    const destinationMember = { ...newFamily.members[destinationMemberIndex] }\n\n    const [removed] = sourceMember.gifts.splice(result.source.index, 1)\n    destinationMember.gifts.splice(result.destination.index, 0, removed)\n\n    // Re-index gifts in both source and destination members\n    sourceMember.gifts = sourceMember.gifts.map((gift, index) => ({ ...gift, order_index: index }));\n    destinationMember.gifts = destinationMember.gifts.map((gift, index) => ({ ...gift, order_index: index }));\n\n    // Optimistically update UI\n    newFamily.members[sourceMemberIndex] = sourceMember\n    newFamily.members[destinationMemberIndex] = destinationMember\n    setFamily(newFamily)\n\n    // Store the original family state for potential rollback\n    const originalFamily = family;\n\n    // Collect all gifts from the entire family structure that need their order_index updated\n    const giftsToUpdate = newFamily.members.flatMap(member =>\n      member.gifts.map(gift => ({\n        id: gift.id,\n        order_index: gift.order_index,\n        list_id: family.id, // Include list_id\n      }))\n    );\n\n    // Call API to update order\n    const res = await fetch('/api/gifts/reorder', {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ items: giftsToUpdate }),\n    })\n\n    if (!res.ok) {\n      const errorText = await res.text()\n      alert(`Failed to reorder gifts: ${errorText}`)\n      // Revert UI on API failure\n      setFamily(originalFamily);\n    }\n\n    setIsDragging(false); // End dragging after all logic is complete\n  }\n\n  const handleDeleteGift = async (giftId: string) => {\n    console.log('Attempting to delete gift:', giftId);\n\n    const res = await fetch(`/api/gifts/${giftId}`, {\n      method: 'DELETE',\n    })\n\n    if (res.ok) {\n      console.log('Gift deleted successfully from API:', giftId);\n      // Update local state to remove the deleted gift\n      const newFamily = { ...family };\n      newFamily.members = newFamily.members.map(member => ({\n        ...member,\n        gifts: member.gifts.filter(gift => gift.id !== giftId)\n      }));\n      setFamily(newFamily);\n      console.log('Local state updated for gift:', giftId);\n    } else {\n      const errorText = await res.text()\n      console.error('Failed to delete gift from API:', giftId, errorText);\n      alert(`Failed to delete gift: ${errorText}`)\n    }\n  }\n\n  const handleSort = (key: keyof Gift | 'order_index') => {\n    if (sortKey === key) {\n      setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc');\n    } else {\n      setSortKey(key);\n      setSortOrder('asc');\n    }\n  };\n\n  const handleRemoveMember = async (memberId: string) => {\n    if (!confirm('Are you sure you want to remove this member? This will delete all of their gifts from the list.')) return\n\n    console.log(`Removing member ${memberId} from family ${family.id}`)\n\n    const res = await fetch(`/api/lists/${family.id}/members/${memberId}`, {\n      method: 'DELETE',\n    })\n\n    if (res.ok) {\n      // Update local state to remove the member and their gifts\n      const newFamily = { ...family };\n      newFamily.members = newFamily.members.filter(member => member.id !== memberId);\n      setFamily(newFamily);\n    } else {\n      const errorText = await res.text()\n      alert(`Failed to remove member: ${errorText}`)\n    }\n  }\n\n  const generateInvite = async () => {\n    const res = await fetch(`/api/lists/${familyId}/invites`, {\n      method: 'POST',\n    })\n\n    if (res.ok) {\n      const { token } = await res.json()\n      setInviteToken(token)\n      setShowQrModal(true)\n    } else {\n      const { error } = await res.json()\n      alert(`Failed to generate invite link: ${error}`)\n    }\n  }\n\n  const handleLeaveFamily = async () => {\n    if (!confirm('Are you sure you want to leave this family list? You will lose access to all gifts and members.')) return\n\n    const res = await fetch(`/api/lists/${family.id}/leave`, {\n      method: 'DELETE',\n    })\n\n    if (res.ok) {\n      alert('You have successfully left the family list.')\n      router.push('/') // Redirect to home page\n    } else {\n      const errorText: any = await res.json()\n      alert(`Failed to leave family: ${errorText.error}`)\n    }\n  }\n\n  const sortedGifts = (gifts: Gift[]) => {\n    return [...gifts].sort((a, b) => {\n      let valA: string | number;\n      let valB: string | number;\n\n      if (sortKey === 'order_index') {\n        valA = a.order_index || 0;\n        valB = b.order_index || 0;\n      } else if (sortKey === 'price') {\n        valA = a.price || 0;\n        valB = b.price || 0;\n      } else {\n        valA = a[sortKey]?.toString().toLowerCase() || '';\n        valB = b[sortKey]?.toString().toLowerCase() || '';\n      }\n\n      if (valA < valB) return sortOrder === 'asc' ? -1 : 1;\n      if (valA > valB) return sortOrder === 'asc' ? 1 : -1;\n      return 0;\n    });\n  };\n\n  return (\n    <div className=\"px-4 py-8 mx-auto fresh-gradient min-h-screen\">\n      <div className=\"max-w-screen-lg mx-auto\">\n        <h1 className=\"text-4xl font-bold mb-4\">{family.name} Christmas List</h1>\n        <Link href=\"/\" className=\"text-blue-500 hover:underline mb-4 block\">← Back to Home</Link>\n\n        <div className=\"mb-4 flex items-center space-x-2\">\n          <span className=\"text-gray-300\">Sort by:</span>\n          <select\n            className=\"px-3 py-1 border border-gray-300 rounded-md text-sm\"\n            value={sortKey}\n            onChange={(e) => handleSort(e.target.value as keyof Gift | 'order_index')}\n          >\n            <option value=\"order_index\">Default Order</option>\n            <option value=\"description\">Description</option>\n            <option value=\"price\">Price</option>\n          </select>\n          <button\n            onClick={() => setSortOrder(sortOrder === 'asc' ? 'desc' : 'asc')}\n            className=\"px-3 py-1 bg-gray-200 rounded-md text-sm\"\n          >\n            {sortOrder === 'asc' ? 'Asc' : 'Desc'}\n          </button>\n          <div className=\"ml-auto flex space-x-2\">\n            <button\n              onClick={() => setViewMode('list')}\n              className={`px-3 py-1 rounded-md text-sm ${viewMode === 'list' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}\n            >\n              ☰ List\n            </button>\n            <button\n              onClick={() => setViewMode('grid')}\n              className={`px-3 py-1 rounded-md text-sm ${viewMode === 'grid' ? 'bg-blue-500 text-white' : 'bg-gray-200'}`}\n            >\n              ▦ Grid\n            </button>\n          </div>\n        </div>\n\n        <DragDropContext\n          onBeforeDragStart={() => {\n            setIsDragging(true);\n          }}\n          onDragEnd={handleDragEnd}\n        >\n          {family.members.map((member) => (\n            <div key={member.id} className=\"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-md mb-8\">\n              <div className=\"flex justify-between items-center\">\n                <h2 className=\"text-2xl font-semibold mb-4\">{member.name}&apos;s List</h2>\n                {user && user.id === family.owner_id && user.id !== member.id && (\n                  <button\n                    onClick={() => handleRemoveMember(member.id)}\n                    className=\"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 text-xs\"\n                  >\n                    Remove\n                  </button>\n                )}\n              </div>\n              {member.gifts.length === 0 ? (\n                <p>No gifts on {member.name}'s list yet.</p>\n              ) : (\n                <Droppable droppableId={member.id}>\n                  {(provided) => (\n                    <ul\n                      className={`${viewMode === 'grid' ? 'grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4' : 'list-disc pl-5 space-y-2'}`}\n                      {...provided.droppableProps}\n                      ref={provided.innerRef}\n                    >\n                      {sortedGifts(member.gifts).map((gift, index) => (\n                        <Draggable key={gift.id} draggableId={gift.id} index={index}>\n                          {(provided) => (\n                            <li\n                              ref={provided.innerRef}\n                              {...provided.draggableProps}\n                              onDoubleClick={() => {\n                                if (user && user.id === gift.user_id) {\n                                  setEditingGift(gift);\n                                }\n                              }}\n                              className=\"flex items-center justify-between bg-gray-50 dark:bg-gray-700 p-2 rounded-md shadow-sm\" // li is now the flex container\n                            >\n                              <div className=\"flex items-center flex-grow\"> {/* Container for image and description */}\n                                {gift.product_image_url && (\n                                  // eslint-disable-next-line @next/next/no-img-element\n                                  <img src={gift.product_image_url} alt={gift.product_title || gift.description} className=\"w-16 h-16 object-cover rounded-md mr-3\" />\n                                )}\n                                <span\n                                  className=\"flex-grow\" // Description span\n                                >\n                                  {gift.description}\n                                  {gift.is_purchased && user?.id !== gift.user_id && (\n                                    <span className=\"ml-2 text-sm text-green-600\">\n                                      (Claimed by {family.members.find(m => m.id === gift.purchased_by)?.name})\n                                    </span>\n                                  )}\n                                </span>\n                              </div>\n                              <div className={`flex items-center flex-shrink-0 ${viewMode === 'grid' ? 'flex-col space-y-2' : 'space-x-2'}`} {...provided.dragHandleProps}> {/* Buttons container, now also drag handle */}\n                                {gift.product_url && (\n                                  <a\n                                    href={gift.product_url}\n                                    target=\"_blank\"\n                                    rel=\"noopener noreferrer\"\n                                    className=\"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-xs\"\n                                    onClick={(e) => e.stopPropagation()} // Prevent expanding gift when clicking link\n                                  >\n                                    Open Link\n                                  </a>\n                                )}\n                                {user && user.id !== gift.user_id && (\n                                  <ClaimUnclaimButtons\n                                    gift={gift}\n                                    userId={user.id}\n                                  />\n                                )}\n                              </div>\n                            </li>\n                          )}\n                        </Draggable>\n                      ))}\n                      {provided.placeholder}\n                      {isDragging && (\n                        <div\n                          className=\"mt-4 p-4 border-2 border-dashed rounded-lg text-center transition-all duration-200\n                            border-gray-300 bg-gray-50 text-gray-500\"\n                        >\n                          Drag outside to delete gift 🗑️\n                        </div>\n                      )}\n                    </ul>\n                  )}\n                </Droppable>\n              )}\n            </div>\n          ))}\n\n          </DragDropContext>\n\n        {user && (\n          <AddGiftForm\n            familyId={family.id}\n            currentUserId={user.id}\n            members={family.members}\n          />\n        )}\n\n        <div className=\"mt-8\">\n          <button\n            onClick={generateInvite}\n            className=\"w-full bg-green-500 text-white py-2 px-4 rounded-md hover:bg-green-600\"\n          >\n            Invite with QR Code\n          </button>\n        </div>\n\n        {user && user.id === family.owner_id && (\n          <AddMemberForm\n            familyId={family.id}\n            currentUserId={user.id}\n            members={family.members}\n          />\n        )}\n\n        {user && user.id !== family.owner_id && (\n          <div className=\"mt-4\">\n            <button\n              onClick={handleLeaveFamily}\n              className=\"w-full bg-red-500 text-white py-2 px-4 rounded-md hover:bg-red-600\"\n            >\n              Leave Family List\n            </button>\n          </div>\n        )}\n\n        {editingGift && (\n          <EditGiftForm\n            gift={editingGift}\n            onClose={() => setEditingGift(null)}\n            onSave={() => {\n              setEditingGift(null)\n              // Instead of router.refresh(), update local state\n              // This would involve refetching the family data or updating the specific gift in the family state\n              // For now, we'll just close the form. A full re-fetch might be needed for complex updates.\n              // router.refresh()\n            }}\n          />\n        )}\n\n        {showQrModal && inviteToken && (\n          <div className=\"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center\">\n            <div className=\"bg-white p-8 rounded-lg shadow-lg text-center\">\n              <h2 className=\"text-2xl font-bold mb-4\">Scan to Join!</h2>\n              <QRCode value={`${window.location.origin}/invite?token=${inviteToken}`} />\n              <button\n                onClick={() => setShowQrModal(false)}\n                className=\"mt-4 px-4 py-2 bg-red-500 text-white rounded-md hover:bg-red-600\"\n              >\n                Close\n              </button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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","debugId":null}}]
}