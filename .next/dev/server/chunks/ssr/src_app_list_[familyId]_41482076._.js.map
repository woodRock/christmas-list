{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/AddGiftForm.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { createClient } from '@/lib/supabase'\nimport { useRouter } from 'next/navigation'\n\ninterface Member {\n  id: string;\n  name: string;\n}\n\ninterface AddGiftFormProps {\n  familyId: string;\n  currentUserId: string;\n  members: Member[];\n}\n\nexport default function AddGiftForm({ familyId, currentUserId, members }: AddGiftFormProps) {\n  const [newGiftDescription, setNewGiftDescription] = useState('')\n  const [selectedRecipientId, setSelectedRecipientId] = useState(currentUserId) // Default to current user\n  const [message, setMessage] = useState('')\n  const supabase = createClient()\n  const router = useRouter()\n\n  const handleAddGift = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setMessage('')\n\n    if (!newGiftDescription) {\n      setMessage('Gift description is required.')\n      return\n    }\n\n    if (!selectedRecipientId) {\n      setMessage('Please select a recipient.')\n      return\n    }\n\n    const { error } = await supabase\n      .from('items')\n      .insert([{ list_id: familyId, user_id: selectedRecipientId, name: newGiftDescription }])\n\n    if (error) {\n      setMessage(`Failed to add gift: ${error.message}`)\n    } else {\n      setMessage(`Gift \"${newGiftDescription}\" added successfully!`)\n      setNewGiftDescription('')\n      router.refresh() // Refresh the current page to show the new gift\n    }\n  }\n\n  return (\n    <div className=\"mt-6 pt-4 border-t border-gray-200\">\n      <h3 className=\"text-xl font-semibold mb-3\">Add a Gift</h3>\n      {message && <p className=\"text-red-500 mb-3\">{message}</p>}\n      <form onSubmit={handleAddGift} className=\"space-y-3\">\n        <div>\n          <label htmlFor=\"recipient\" className=\"block text-sm font-medium text-gray-700\">Recipient</label>\n          <select\n            id=\"recipient\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={selectedRecipientId}\n            onChange={(e) => setSelectedRecipientId(e.target.value)}\n            required\n          >\n            {members.map((member) => (\n              <option key={member.id} value={member.id}>\n                {member.name} {member.id === currentUserId ? '(You)' : ''}\n              </option>\n            ))}\n          </select>\n        </div>\n        <div>\n          <label htmlFor=\"gift-desc\" className=\"sr-only\">\n            Gift Description\n          </label>\n          <input\n            type=\"text\"\n            id=\"gift-desc\"\n            placeholder=\"Gift description\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newGiftDescription}\n            onChange={(e) => setNewGiftDescription(e.target.value)}\n            required\n          />\n        </div>\n        <button\n          type=\"submit\"\n          className=\"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 text-sm\"\n        >\n          Add Gift\n        </button>\n      </form>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAiBe,SAAS,YAAY,EAAE,QAAQ,EAAE,aAAa,EAAE,OAAO,EAAoB;IACxF,MAAM,CAAC,oBAAoB,sBAAsB,GAAG,IAAA,iNAAQ,EAAC;IAC7D,MAAM,CAAC,qBAAqB,uBAAuB,GAAG,IAAA,iNAAQ,EAAC,eAAe,0BAA0B;;IACxG,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,WAAW,IAAA,sIAAY;IAC7B,MAAM,SAAS,IAAA,+IAAS;IAExB,MAAM,gBAAgB,OAAO;QAC3B,EAAE,cAAc;QAChB,WAAW;QAEX,IAAI,CAAC,oBAAoB;YACvB,WAAW;YACX;QACF;QAEA,IAAI,CAAC,qBAAqB;YACxB,WAAW;YACX;QACF;QAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,SACL,MAAM,CAAC;YAAC;gBAAE,SAAS;gBAAU,SAAS;gBAAqB,MAAM;YAAmB;SAAE;QAEzF,IAAI,OAAO;YACT,WAAW,CAAC,oBAAoB,EAAE,MAAM,OAAO,EAAE;QACnD,OAAO;YACL,WAAW,CAAC,MAAM,EAAE,mBAAmB,qBAAqB,CAAC;YAC7D,sBAAsB;YACtB,OAAO,OAAO,IAAG,gDAAgD;QACnE;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAA6B;;;;;;YAC1C,yBAAW,8OAAC;gBAAE,WAAU;0BAAqB;;;;;;0BAC9C,8OAAC;gBAAK,UAAU;gBAAe,WAAU;;kCACvC,8OAAC;;0CACC,8OAAC;gCAAM,SAAQ;gCAAY,WAAU;0CAA0C;;;;;;0CAC/E,8OAAC;gCACC,IAAG;gCACH,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,uBAAuB,EAAE,MAAM,CAAC,KAAK;gCACtD,QAAQ;0CAEP,QAAQ,GAAG,CAAC,CAAC,uBACZ,8OAAC;wCAAuB,OAAO,OAAO,EAAE;;4CACrC,OAAO,IAAI;4CAAC;4CAAE,OAAO,EAAE,KAAK,gBAAgB,UAAU;;uCAD5C,OAAO,EAAE;;;;;;;;;;;;;;;;kCAM5B,8OAAC;;0CACC,8OAAC;gCAAM,SAAQ;gCAAY,WAAU;0CAAU;;;;;;0CAG/C,8OAAC;gCACC,MAAK;gCACL,IAAG;gCACH,aAAY;gCACZ,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,sBAAsB,EAAE,MAAM,CAAC,KAAK;gCACrD,QAAQ;;;;;;;;;;;;kCAGZ,8OAAC;wBACC,MAAK;wBACL,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT","debugId":null}},
    {"offset": {"line": 169, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/ClaimUnclaimButtons.tsx"],"sourcesContent":["'use client'\n\nimport { createClient } from '@/lib/supabase'\nimport { useRouter } from 'next/navigation'\nimport { useState } from 'react'\n\ninterface Gift {\n  id: string;\n  description: string;\n  is_purchased: boolean;\n  purchased_by?: string;\n  user_id: string;\n}\n\ninterface ClaimUnclaimButtonsProps {\n  gift: Gift;\n  userId: string;\n}\n\nexport default function ClaimUnclaimButtons({ gift, userId }: ClaimUnclaimButtonsProps) {\n  const [message, setMessage] = useState('')\n  const router = useRouter()\n\n  const handleClaimGift = async () => {\n    setMessage('')\n    const res = await fetch(`/api/gifts/${gift.id}/claim`, {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ claimedByUserId: userId }),\n    })\n\n    if (res.ok) {\n      setMessage('Gift claimed successfully!')\n      router.refresh()\n    } else {\n      const errorText = await res.text()\n      setMessage(`Failed to claim gift: ${errorText}`)\n    }\n  }\n\n  const handleUnclaimGift = async () => {\n    setMessage('')\n    const res = await fetch(`/api/gifts/${gift.id}/unclaim`, {\n      method: 'PATCH', // Changed to PATCH as per API route\n      headers: { 'Content-Type': 'application/json' },\n    })\n\n    if (res.ok) {\n      setMessage('Gift unclaimed successfully!')\n      router.refresh()\n    } else {\n      const errorText = await res.text()\n      setMessage(`Failed to unclaim gift: ${errorText}`)\n    }\n  }\n\n  return (\n    <div>\n      {message && <p className=\"text-red-500 text-sm mb-2\">{message}</p>}\n      {!gift.is_purchased && (\n        <button\n          onClick={handleClaimGift}\n          className=\"ml-4 px-3 py-1 bg-purple-600 text-white rounded-md hover:bg-purple-700 text-sm\"\n        >\n          Claim\n        </button>\n      )}\n      {gift.is_purchased && gift.purchased_by === userId && (\n        <button\n          onClick={handleUnclaimGift}\n          className=\"ml-4 px-3 py-1 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 text-sm\"\n        >\n          Unclaim\n        </button>\n      )}\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAJA;;;;AAmBe,SAAS,oBAAoB,EAAE,IAAI,EAAE,MAAM,EAA4B;IACpF,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,SAAS,IAAA,+IAAS;IAExB,MAAM,kBAAkB;QACtB,WAAW;QACX,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,KAAK,EAAE,CAAC,MAAM,CAAC,EAAE;YACrD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,iBAAiB;YAAO;QACjD;QAEA,IAAI,IAAI,EAAE,EAAE;YACV,WAAW;YACX,OAAO,OAAO;QAChB,OAAO;YACL,MAAM,YAAY,MAAM,IAAI,IAAI;YAChC,WAAW,CAAC,sBAAsB,EAAE,WAAW;QACjD;IACF;IAEA,MAAM,oBAAoB;QACxB,WAAW;QACX,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,KAAK,EAAE,CAAC,QAAQ,CAAC,EAAE;YACvD,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;QAChD;QAEA,IAAI,IAAI,EAAE,EAAE;YACV,WAAW;YACX,OAAO,OAAO;QAChB,OAAO;YACL,MAAM,YAAY,MAAM,IAAI,IAAI;YAChC,WAAW,CAAC,wBAAwB,EAAE,WAAW;QACnD;IACF;IAEA,qBACE,8OAAC;;YACE,yBAAW,8OAAC;gBAAE,WAAU;0BAA6B;;;;;;YACrD,CAAC,KAAK,YAAY,kBACjB,8OAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;YAIF,KAAK,YAAY,IAAI,KAAK,YAAY,KAAK,wBAC1C,8OAAC;gBACC,SAAS;gBACT,WAAU;0BACX;;;;;;;;;;;;AAMT","debugId":null}},
    {"offset": {"line": 257, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/AddMemberForm.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { createClient } from '@/lib/supabase'\nimport { useRouter } from 'next/navigation'\n\ninterface AddMemberFormProps {\n  familyId: string;\n  currentUserId: string;\n  members: { id: string; name: string }[];\n}\n\nexport default function AddMemberForm({ familyId, currentUserId, members }: AddMemberFormProps) {\n  const [newMemberName, setNewMemberName] = useState('')\n  const [newMemberEmail, setNewMemberEmail] = useState('') // Assuming email for finding user ID\n  const [message, setMessage] = useState('')\n  const supabase = createClient()\n  const router = useRouter()\n\n  const handleAddMember = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setMessage('')\n\n    console.log(\"Attempting to add member:\", { newMemberName, newMemberEmail, familyId, currentUserId });\n\n    if (!newMemberName || !newMemberEmail) {\n      setMessage('Member name and email are required.')\n      return\n    }\n\n    // First, check if the current user is part of this family list\n    const isCurrentUserMember = members.some(member => member.id === currentUserId);\n    if (!isCurrentUserMember) {\n      setMessage('You must be a member of this list to add new members.');\n      return;\n    }\n\n    try {\n      const res = await fetch(`/api/family/${familyId}/members`, {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({ memberName: newMemberName, memberEmail: newMemberEmail }),\n      });\n\n      console.log(\"API response status:\", res.status);\n      const data = await res.json();\n      console.log(\"API response data:\", data);\n\n      if (res.ok) {\n        setMessage(data.message);\n        setNewMemberName('');\n        setNewMemberEmail('');\n        router.refresh(); // Refresh the page to show the new member in the dropdowns\n      } else {\n        setMessage(`Failed to add member: ${data.error}`);\n      }\n    } catch (error: any) {\n      setMessage(`Error adding member: ${error.message}`);\n      console.error(\"Error during add member fetch:\", error);\n    }\n  }\n\n  return (\n    <div className=\"mt-8 p-6 bg-white rounded-lg shadow-md\">\n      <h3 className=\"text-2xl font-semibold mb-4\">Add New Family Member</h3>\n      {message && <p className=\"text-red-500 mb-4\">{message}</p>}\n      <form onSubmit={handleAddMember} className=\"space-y-4\">\n        <div>\n          <label htmlFor=\"newMemberName\" className=\"block text-sm font-medium text-gray-700\">Member Name</label>\n          <input\n            type=\"text\"\n            id=\"newMemberName\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newMemberName}\n            onChange={(e) => setNewMemberName(e.target.value)}\n            required\n          />\n        </div>\n        <div>\n          <label htmlFor=\"newMemberEmail\" className=\"block text-sm font-medium text-gray-700\">Member Email</label>\n          <input\n            type=\"email\"\n            id=\"newMemberEmail\"\n            className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n            value={newMemberEmail}\n            onChange={(e) => setNewMemberEmail(e.target.value)}\n            required\n          />\n        </div>\n        <button\n          type=\"submit\"\n          className=\"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm\"\n        >\n          Add Member\n        </button>\n      </form>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AAJA;;;;;AAYe,SAAS,cAAc,EAAE,QAAQ,EAAE,aAAa,EAAE,OAAO,EAAsB;IAC5F,MAAM,CAAC,eAAe,iBAAiB,GAAG,IAAA,iNAAQ,EAAC;IACnD,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAC,IAAI,qCAAqC;;IAC9F,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,WAAW,IAAA,sIAAY;IAC7B,MAAM,SAAS,IAAA,+IAAS;IAExB,MAAM,kBAAkB,OAAO;QAC7B,EAAE,cAAc;QAChB,WAAW;QAEX,QAAQ,GAAG,CAAC,6BAA6B;YAAE;YAAe;YAAgB;YAAU;QAAc;QAElG,IAAI,CAAC,iBAAiB,CAAC,gBAAgB;YACrC,WAAW;YACX;QACF;QAEA,+DAA+D;QAC/D,MAAM,sBAAsB,QAAQ,IAAI,CAAC,CAAA,SAAU,OAAO,EAAE,KAAK;QACjE,IAAI,CAAC,qBAAqB;YACxB,WAAW;YACX;QACF;QAEA,IAAI;YACF,MAAM,MAAM,MAAM,MAAM,CAAC,YAAY,EAAE,SAAS,QAAQ,CAAC,EAAE;gBACzD,QAAQ;gBACR,SAAS;oBAAE,gBAAgB;gBAAmB;gBAC9C,MAAM,KAAK,SAAS,CAAC;oBAAE,YAAY;oBAAe,aAAa;gBAAe;YAChF;YAEA,QAAQ,GAAG,CAAC,wBAAwB,IAAI,MAAM;YAC9C,MAAM,OAAO,MAAM,IAAI,IAAI;YAC3B,QAAQ,GAAG,CAAC,sBAAsB;YAElC,IAAI,IAAI,EAAE,EAAE;gBACV,WAAW,KAAK,OAAO;gBACvB,iBAAiB;gBACjB,kBAAkB;gBAClB,OAAO,OAAO,IAAI,2DAA2D;YAC/E,OAAO;gBACL,WAAW,CAAC,sBAAsB,EAAE,KAAK,KAAK,EAAE;YAClD;QACF,EAAE,OAAO,OAAY;YACnB,WAAW,CAAC,qBAAqB,EAAE,MAAM,OAAO,EAAE;YAClD,QAAQ,KAAK,CAAC,kCAAkC;QAClD;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC;gBAAG,WAAU;0BAA8B;;;;;;YAC3C,yBAAW,8OAAC;gBAAE,WAAU;0BAAqB;;;;;;0BAC9C,8OAAC;gBAAK,UAAU;gBAAiB,WAAU;;kCACzC,8OAAC;;0CACC,8OAAC;gCAAM,SAAQ;gCAAgB,WAAU;0CAA0C;;;;;;0CACnF,8OAAC;gCACC,MAAK;gCACL,IAAG;gCACH,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,iBAAiB,EAAE,MAAM,CAAC,KAAK;gCAChD,QAAQ;;;;;;;;;;;;kCAGZ,8OAAC;;0CACC,8OAAC;gCAAM,SAAQ;gCAAiB,WAAU;0CAA0C;;;;;;0CACpF,8OAAC;gCACC,MAAK;gCACL,IAAG;gCACH,WAAU;gCACV,OAAO;gCACP,UAAU,CAAC,IAAM,kBAAkB,EAAE,MAAM,CAAC,KAAK;gCACjD,QAAQ;;;;;;;;;;;;kCAGZ,8OAAC;wBACC,MAAK;wBACL,WAAU;kCACX;;;;;;;;;;;;;;;;;;AAMT","debugId":null}},
    {"offset": {"line": 430, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/EditGiftForm.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { createClient } from '@/lib/supabase'\n\ninterface Gift {\n  id: string;\n  description: string;\n}\n\ninterface EditGiftFormProps {\n  gift: Gift;\n  onClose: () => void;\n  onSave: () => void;\n}\n\nexport default function EditGiftForm({ gift, onClose, onSave }: EditGiftFormProps) {\n  const [newDescription, setNewDescription] = useState(gift.description)\n  const [message, setMessage] = useState('')\n  const supabase = createClient()\n\n  const handleSave = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setMessage('')\n\n    if (!newDescription) {\n      setMessage('Gift description cannot be empty.')\n      return\n    }\n\n    const res = await fetch(`/api/gifts/${gift.id}`, {\n      method: 'PATCH',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({ description: newDescription }),\n    })\n\n    if (res.ok) {\n      setMessage('Gift updated successfully!')\n      onSave()\n    } else {\n      const errorText = await res.text()\n      setMessage(`Failed to update gift: ${errorText}`)\n    }\n  }\n\n  return (\n    <div className=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full flex items-center justify-center\">\n      <div className=\"bg-white p-8 rounded-lg shadow-xl max-w-md w-full\">\n        <h2 className=\"text-2xl font-bold mb-4\">Edit Gift</h2>\n        {message && <p className=\"text-red-500 mb-4\">{message}</p>}\n        <form onSubmit={handleSave} className=\"space-y-4\">\n          <div>\n            <label htmlFor=\"gift-description\" className=\"block text-sm font-medium text-gray-700\">Gift Description</label>\n            <input\n              type=\"text\"\n              id=\"gift-description\"\n              className=\"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm\"\n              value={newDescription}\n              onChange={(e) => setNewDescription(e.target.value)}\n              required\n            />\n          </div>\n          <div className=\"flex justify-end space-x-2\">\n            <button\n              type=\"button\"\n              onClick={onClose}\n              className=\"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500\"\n            >\n              Cancel\n            </button>\n            <button\n              type=\"submit\"\n              className=\"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500\"\n            >\n              Save Changes\n            </button>\n          </div>\n        </form>\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAHA;;;;AAgBe,SAAS,aAAa,EAAE,IAAI,EAAE,OAAO,EAAE,MAAM,EAAqB;IAC/E,MAAM,CAAC,gBAAgB,kBAAkB,GAAG,IAAA,iNAAQ,EAAC,KAAK,WAAW;IACrE,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,iNAAQ,EAAC;IACvC,MAAM,WAAW,IAAA,sIAAY;IAE7B,MAAM,aAAa,OAAO;QACxB,EAAE,cAAc;QAChB,WAAW;QAEX,IAAI,CAAC,gBAAgB;YACnB,WAAW;YACX;QACF;QAEA,MAAM,MAAM,MAAM,MAAM,CAAC,WAAW,EAAE,KAAK,EAAE,EAAE,EAAE;YAC/C,QAAQ;YACR,SAAS;gBAAE,gBAAgB;YAAmB;YAC9C,MAAM,KAAK,SAAS,CAAC;gBAAE,aAAa;YAAe;QACrD;QAEA,IAAI,IAAI,EAAE,EAAE;YACV,WAAW;YACX;QACF,OAAO;YACL,MAAM,YAAY,MAAM,IAAI,IAAI;YAChC,WAAW,CAAC,uBAAuB,EAAE,WAAW;QAClD;IACF;IAEA,qBACE,8OAAC;QAAI,WAAU;kBACb,cAAA,8OAAC;YAAI,WAAU;;8BACb,8OAAC;oBAAG,WAAU;8BAA0B;;;;;;gBACvC,yBAAW,8OAAC;oBAAE,WAAU;8BAAqB;;;;;;8BAC9C,8OAAC;oBAAK,UAAU;oBAAY,WAAU;;sCACpC,8OAAC;;8CACC,8OAAC;oCAAM,SAAQ;oCAAmB,WAAU;8CAA0C;;;;;;8CACtF,8OAAC;oCACC,MAAK;oCACL,IAAG;oCACH,WAAU;oCACV,OAAO;oCACP,UAAU,CAAC,IAAM,kBAAkB,EAAE,MAAM,CAAC,KAAK;oCACjD,QAAQ;;;;;;;;;;;;sCAGZ,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCACC,MAAK;oCACL,SAAS;oCACT,WAAU;8CACX;;;;;;8CAGD,8OAAC;oCACC,MAAK;oCACL,WAAU;8CACX;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQb","debugId":null}},
    {"offset": {"line": 573, "column": 0}, "map": {"version":3,"sources":["file:///Users/woodj/Desktop/christmas-list/src/app/list/%5BfamilyId%5D/FamilyListClient.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { createClient } from '@/lib/supabase'\nimport { useRouter } from 'next/navigation'\nimport { DragDropContext, Droppable, Draggable, DropResult } from '@hello-pangea/dnd'\nimport Link from 'next/link'\nimport AddGiftForm from './AddGiftForm'\nimport ClaimUnclaimButtons from './ClaimUnclaimButtons'\nimport AddMemberForm from './AddMemberForm'\nimport EditGiftForm from './EditGiftForm' // New component for editing gifts\n\ninterface Gift {\n  id: string;\n  description: string;\n  is_purchased: boolean;\n  purchased_by?: string;\n  user_id: string;\n  order_index?: number; // Add order_index\n}\n\ninterface Member {\n  id: string;\n  name: string;\n  gifts: Gift[];\n}\n\ninterface Family {\n  id: string;\n  name: string;\n  owner_id: string;\n  members: Member[];\n}\n\nexport default function FamilyListClient({ initialFamily, initialUser, familyId }: { initialFamily: Family, initialUser: any, familyId: string }) {\n  const [family, setFamily] = useState<Family>(initialFamily)\n  const [user] = useState(initialUser)\n  const [editingGift, setEditingGift] = useState<Gift | null>(null)\n  const supabase = createClient()\n  const router = useRouter()\n\n  const handleDragEnd = async (result: DropResult) => {\n    if (!result.destination) return\n\n    const sourceMemberIndex = family.members.findIndex(m => m.id === result.source.droppableId)\n    const destinationMemberIndex = family.members.findIndex(m => m.id === result.destination?.droppableId)\n\n    if (sourceMemberIndex === -1 || destinationMemberIndex === -1) return\n\n    const newFamily = { ...family }\n    const sourceMember = { ...newFamily.members[sourceMemberIndex] }\n    const destinationMember = { ...newFamily.members[destinationMemberIndex] }\n\n    const [removed] = sourceMember.gifts.splice(result.source.index, 1)\n    destinationMember.gifts.splice(result.destination.index, 0, removed)\n\n    // Update order_index for all affected gifts\n    const updatedGifts = destinationMember.gifts.map((gift, index) => ({\n      ...gift,\n      order_index: index,\n    }))\n\n    // Optimistically update UI\n    newFamily.members[sourceMemberIndex] = sourceMember\n    newFamily.members[destinationMemberIndex] = destinationMember\n    setFamily(newFamily)\n\n    // Call API to update order\n    const { error } = await supabase\n      .from('items')\n      .upsert(updatedGifts.map(g => ({ id: g.id, order_index: g.order_index })))\n\n    if (error) {\n      console.error('Error reordering gifts:', error)\n      // Revert UI if API call fails\n      router.refresh()\n    }\n  }\n\n  const handleDeleteGift = async (giftId: string) => {\n    if (!confirm('Are you sure you want to delete this gift?')) return\n\n    const res = await fetch(`/api/gifts/${giftId}`, {\n      method: 'DELETE',\n    })\n\n    if (res.ok) {\n      router.refresh()\n    } else {\n      const errorText = await res.text()\n      alert(`Failed to delete gift: ${errorText}`)\n    }\n  }\n\n  return (\n    <div className=\"px-4 py-8 mx-auto fresh-gradient min-h-screen\">\n      <div className=\"max-w-screen-lg mx-auto\">\n        <h1 className=\"text-4xl font-bold mb-4\">{family.name} Christmas List</h1>\n        <Link href=\"/\" className=\"text-blue-500 hover:underline mb-4 block\">‚Üê Back to Home</Link>\n\n        {family.members.map((member) => (\n          <div key={member.id} className=\"bg-white p-6 rounded-lg shadow-md mb-8\">\n            <h2 className=\"text-2xl font-semibold mb-4\">{member.name}'s List</h2>\n            {member.gifts.length === 0 ? (\n              <p>No gifts on {member.name}'s list yet.</p>\n            ) : (\n              <DragDropContext onDragEnd={handleDragEnd}>\n                <Droppable droppableId={member.id}>\n                  {(provided) => (\n                    <ul\n                      className=\"list-disc pl-5 space-y-2\"\n                      {...provided.droppableProps}\n                      ref={provided.innerRef}\n                    >\n                      {member.gifts.sort((a, b) => (a.order_index || 0) - (b.order_index || 0)).map((gift, index) => (\n                        <Draggable key={gift.id} draggableId={gift.id} index={index}>\n                          {(provided) => (\n                            <li\n                              ref={provided.innerRef}\n                              {...provided.draggableProps}\n                              {...provided.dragHandleProps}\n                              className=\"flex justify-between items-center bg-gray-50 p-2 rounded-md shadow-sm\"\n                            >\n                              <span>\n                                {gift.description}\n                                {gift.is_purchased && user.id !== gift.user_id && (\n                                  <span className=\"ml-2 text-sm text-green-600\">\n                                    (Claimed by {family.members.find(m => m.id === gift.purchased_by)?.name})\n                                  </span>\n                                )}\n                              </span>\n                              <div className=\"flex items-center space-x-2\">\n                                {user && user.id === gift.user_id && ( // Only owner can edit/delete\n                                  <>\n                                    <button\n                                      onClick={() => setEditingGift(gift)}\n                                      className=\"px-2 py-1 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-xs\"\n                                    >\n                                      Edit\n                                    </button>\n                                    <button\n                                      onClick={() => handleDeleteGift(gift.id)}\n                                      className=\"px-2 py-1 bg-red-500 text-white rounded-md hover:bg-red-600 text-xs\"\n                                    >\n                                      Delete\n                                    </button>\n                                  </>\n                                )}\n                                {user && user.id !== gift.user_id && (\n                                  <ClaimUnclaimButtons\n                                    gift={gift}\n                                    userId={user.id}\n                                  />\n                                )}\n                              </div>\n                            </li>\n                          )}\n                        </Draggable>\n                      ))}\n                      {provided.placeholder}\n                    </ul>\n                  )}\n                </Droppable>\n              </DragDropContext>\n            )}\n          </div>\n        ))}\n\n        {user && (\n          <AddGiftForm\n            familyId={family.id}\n            currentUserId={user.id}\n            members={family.members}\n          />\n        )}\n\n        {user && (\n          <AddMemberForm\n            familyId={family.id}\n            currentUserId={user.id}\n            members={family.members}\n          />\n        )}\n\n        {editingGift && (\n          <EditGiftForm\n            gift={editingGift}\n            onClose={() => setEditingGift(null)}\n            onSave={() => {\n              setEditingGift(null)\n              router.refresh()\n            }}\n          />\n        )}\n      </div>\n    </div>\n  )\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}